---
title: Обновить NodeJS
lastChanged: 30.05.2019
translatedFrom: de
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translationFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/install/updatenode.md
hash: MPmZUM6TWpDMUxNDz1o1kaEj1vxig35ozaoOi5UeK+M=
---
# Обновление NodeJS для ioBroker
Каждый год выпускается новая версия Node.js, которая помечается как LTS (долгосрочная поддержка) с прямым номером версии и будет поддерживаться в течение нескольких лет.
В то же время, более ранняя версия Node.js LTS достигает конца своей жизни (`End of Life`).
В 2019 году NodeJS версия 12 будет объявлена LTS в октябре, а версия 6 была выпущена в конце срока эксплуатации.

Несмотря на то, что js-контроллер до версии 1.5.11 по-прежнему поддерживает Node.js начиная с версии 4, новые адаптеры появляются все чаще и чаще, например, с. Node.js 8 как основное требование, потому что каждая новая версия Node.js приносит новые функции.

Все версии Node.js с нечетными номерами версий являются версиями для разработчиков и официально не поддерживаются и не должны использоваться!

Но даже последняя версия не имеет смысла, потому что здесь часто встречаются не совсем совместимые библиотеки.
На данный момент Node.js 10 будет рекомендуемой версией.

Каждые несколько лет обновляется Node.js для установки ioBroker, и в этой статье следует кратко изложить, как мы это делаем лучше всего.

Прежде всего, ioBroker должен быть остановлен, чтобы обновления не вызывали никаких побочных эффектов или сбоев.
Также проверьте, завершены ли все процессы, которые начинались с `io.`.

Кроме того, конечно, резервная копия должна быть обязательно создана.
Вы можете использовать адаптер BackItUp или командную строку

```iobroker backup```

Следующим шагом является обновление Node.js в системе до желаемой новой версии.
В Linux достаточно просто выполнить команды установки Nodesource, как указано в [https://github.com/nodesource/distributions#debinstall](https://github.com/nodesource/distributions#debinstall).
Для macOS на [https://nodejs.org/en/download/](https://nodejs.org/en/download/) есть установщик, который вы просто переустанавливаете.
Если установщик ioBroker использовался под Windows, пожалуйста, НЕ обновляйте версию Nodejs / npm самостоятельно, а следуйте инструкциям установщика.

К сожалению, это только половина работы, так как используется много модулей, которые будут установлены во время установки для текущего тогда Node.js.
При обновлении Node.js все эти модули должны быть обновлены, иначе будут ошибки во время выполнения.

Есть несколько способов обновить это:

1. **восстановление npm**

Первая попытка всегда должна быть сделана с командой `npm rebuild` в каталоге ioBroker, потому что это работает наиболее чисто и выполняется непосредственно управлением пакетами. В идеале это займет несколько минут, и некоторые предупреждения могут быть перечислены.
Но если есть ошибки, то вы должны точно их проверить и решить ... это сложная часть здесь.
В следующем посте мы попытаемся собрать все известные из этих случаев с вашими подходами решения.
Если это работает, это самый быстрый и чистый способ.

2. **переустановить скрипт**

Если этого не происходит, контроллер js включает скрипт переустановки (reinstall.sh или js-controller 1.5 reinstall.js).
Этот скрипт обнаружит все установленные адаптеры ioBroker, затем удалит их из каталога node_modules и переустановит.
Этот подход немного дороже, чем пересборка npm, но он служит той же цели. Это обычно работает хорошо, но вы не должны нарушать процесс. Если это произойдет или возникнут проблемы, начинающиеся после этой процедуры, то лучше всего выбрать путь в следующей точке.
Сценарий reinstall.sh, который был включен в js-controller 1.4, имеет проблему с форматированием и должен использоваться для Linux с командой

... ??? быть исправлено так оно и есть.

3. **сброс узловых модулей**

Другой вариант, который занимает немного больше времени, - это просто удалить все модули ode-JS, вручную установить js-контроллер, а затем запустить ioBroker и автоматически установить отсутствующие адаптеры.
Для этого удалите весь каталог node_modules в каталоге ioBroker. Затем вы устанавливаете контроллер в соответствующей версии (здесь, например, 1.5.12, которая в настоящее время стабильна):

```npm install iobroker.js-controller@1.5.12 --production  --no-optional --logevel=error```

Затем вы запускаете ioBroker. Важно, чтобы каталог iobroker-data не изменялся.
Затем ioBroker запускается и по очереди обнаруживает, что адаптеры, которые он хочет запустить, не установлены, и устанавливают их. В зависимости от системы это может занять некоторое время - иногда до нескольких часов (или всю ночь на медленных SD-картах).
Но тогда все должно быть обновлено.

4. **Переустановка с восстановлением**

Небольшая модификация последнего варианта - переустановка. Это защищает каталог `iobroker-data` (или использует резервную копию сверху). Затем удалите весь каталог ioBroker и используйте установщик.
Сразу после этого ioBroker снова останавливается (который запускается автоматически после установки) и копирует каталог iobroker-data или использует `iobroker restore`. Затем вы снова запускаете ioBroker.
Остальная часть запускается как в варианте 3 и занимает свое время.

Пожалуйста, дайте отзыв о том, что работает для вас, что вы используете и каковы проблемы и ваши решения.