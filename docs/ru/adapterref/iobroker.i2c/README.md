---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translatedFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/adapterref/iobroker.i2c/README.md
title: ioBroker.i2c
hash: HiafKBZXcIvhJGJZZKuT+LfM2j3JgZ8pnQi59bg3gY8=
---
![Логотип](../../../en/adapterref/iobroker.i2c/admin/i2c.png)

![Версия NPM](http://img.shields.io/npm/v/iobroker.i2c.svg)
![Загрузки](https://img.shields.io/npm/dm/iobroker.i2c.svg)
![Количество установок (последнее)](http://iobroker.live/badges/i2c-installed.svg)
![Количество установок (стабильно)](http://iobroker.live/badges/i2c-stable.svg)
![Статус зависимости](https://img.shields.io/david/UncleSamSwiss/iobroker.i2c.svg)
![Известные уязвимости](https://snyk.io/test/github/UncleSamSwiss/ioBroker.i2c/badge.svg)
![НПМ](https://nodei.co/npm/iobroker.i2c.png?downloads=true)

# IoBroker.i2c
[![Статус перевода] (https://weblate.iobroker.net/widgets/adapters/-/i2c/svg-badge.svg)](https://weblate.iobroker.net/engage/adapters/?utm_source=widget)

** Тесты: ** ![Тестирование и выпуск](https://github.com/UncleSamSwiss/ioBroker.i2c/workflows/Test%20and%20Release/badge.svg)

## Адаптер I2C для ioBroker
Обменивается данными с устройствами, подключенными к локальной системе по шине I2C.

Этот адаптер должен работать на платах Linux, таких как Raspberry Pi, C.H.I.P., BeagleBone или Intel Edison.

## Установить
Перед установкой прочтите [руководство по установке модуля i2c-bus](https://www.npmjs.com/package/i2c-bus#installation).

Особенно убедитесь, что вы правильно настроили и включили I2C в своей системе (при необходимости):

- [Настройка I2C на Raspberry Pi] (https://github.com/fivdi/i2c-bus/blob/master/doc/raspberry-pi-i2c.md)
- [Настройка I2C на базовой плате Intel Edison Arduino] (https://github.com/fivdi/i2c-bus/blob/master/doc/edison-adruino-base-board-i2c.md)

После того, как вы включили и настроили I2C, вы можете установить этот адаптер через ioBroker Admin:

1. Запустите адаптер (он должен работать, чтобы обнаружение работало).
2. Откройте диалоговое окно конфигурации экземпляра.
3. Нажмите кнопку «Поиск устройств», чтобы обнаружить все подключенные устройства I2C - это займет некоторое время, наберитесь терпения!
4. Настройте все найденные устройства на соответствующих вкладках.
5. Сохраните конфигурацию (это перезапустит адаптер).

### Проблема с правом доступа
В зависимости от возраста вашей установки ioBroker пользователь `iobroker` (или другой пользователь, работающий под управлением ioBroker) может не иметь надлежащих прав для доступа к I2C.

Если вы подключили устройство и оно не отображается на экране конфигурации, убедитесь, что пользователь добавлен в группу `i2c`:

```sh
sudo usermod -aG i2c iobroker
```

Примечание: если у вас нет стандартной установки, замените `iobroker` в приведенной выше команде на пользователя, запустившего вашу установку ioBroker (проверьте с `ps`).

## Конфигурация
### Номер автобуса
Это номер шины / адаптера I2C, который нужно открыть, 0 для / dev / i2c-0, 1 для / dev / i2c-1, ...

На Raspberry Pi 3 и 4B это «1».

## Поддерживаемые устройства
В настоящее время поддерживаются следующие устройства. Цифры в скобках - это известные адреса устройства в шестнадцатеричном формате (без бита чтения).

### Датчик почвы Adafruit STEMMA (36)
Датчик почвы Adafruit STEMMA - емкостный датчик влажности I2C с использованием микросхемы ATSAMD10.

### ADS1015 16-разрядный 4-канальный АЦП (48-4B)
Texas Instruments 4x 3,3-kSPS, 12-разрядные АЦП с внутренним опорным сигналом.

### ADS1115 16-разрядный 4-канальный АЦП (48-4B)
Texas Instruments 4x 860-SPS, 16-разрядные АЦП с внутренним опорным сигналом.

### BME280 (76, 77)
Цифровой датчик влажности, давления и температуры Bosch.

### GY-US42 Гидролокатор-дальномер (70)
Гидролокатор MaxSonar GY-US42 20-720см.

### HMC5883L 3-осевой цифровой компас (1E)
3-осевой цифровой компас Honeywell IC.

### INA219 Монитор тока / мощности (40-4F)
Двунаправленный монитор тока / мощности Texas Instruments с нулевым дрейфом.

### MCP23008 8-битный расширитель ввода / вывода (20-27)
8-битный расширитель ввода / вывода Microchip с последовательным интерфейсом.

### MCP23017 16-битный расширитель ввода / вывода (20-27)
16-разрядный расширитель ввода / вывода Microchip с последовательным интерфейсом.

### MCP3422 18-разрядный 2-канальный АЦП (68)
Microchip 18-разрядный, 2-канальный аналого-цифровой преобразователь с бортовым Reference.

### MCP3423 18-разрядный 2-канальный АЦП (68-6F)
Microchip 18-разрядный, 2-канальный аналого-цифровой преобразователь с бортовым Reference.

### MCP3424 18-разрядный 4-канальный АЦП (68-6F)
Microchip 18-разрядный, 4-канальный аналого-цифровой преобразователь с бортовым Reference.

### MCP3426 16-битный 2-канальный АЦП (68)
Microchip 16-разрядный, 2-канальный аналого-цифровой преобразователь с бортовым Reference.

### MCP3427 16-разрядный 2-канальный АЦП (68-6F)
Microchip 16-разрядный, 2-канальный аналого-цифровой преобразователь с бортовым Reference.

### MCP3428 16-разрядный 4-канальный АЦП (68-6F)
Microchip 16-разрядный, 4-канальный аналого-цифровой преобразователь с бортовым Reference.

### 12-разрядный цифро-аналоговый преобразователь MCP4725 (60-67)
12-разрядный цифро-аналоговый преобразователь Microchip с памятью EEPROM.

### PCF8574 8-битный расширитель ввода / вывода (20-27)
8-разрядный удаленный расширитель ввода / вывода Texas Instruments для шины I2C.

### PCF8574A 8-битный расширитель ввода / вывода (38-3F)
8-разрядный удаленный расширитель ввода / вывода Texas Instruments для шины I2C.

### PCA9685 16-канальный 12-битный драйвер серво / светодиода PWM (40-7F)
Коммутационная плата Adafruit PCA9685 для 16-канальной 12-битной ШИМ. Адаптер ориентирован на использование 16 каналов от 0..4095 в качестве светорегулятора.
Может управлять многими светодиодами, когда PWM (и GND) подключен к N-канальному модулю Mosfet, например. на основе D4184. Подключите LED GND к MOSFET и + 12/24 / n V к PSU.

### QMC5883L 3-осевой магнитный датчик (0D)
3-осевой магнитный датчик QST.

### Датчик влажности и температуры SHT3x (44-45)
Датчик влажности и температуры Sensirion SHT3x.

### SRF02 Ультразвуковой искатель рейнджеров (70)
Devantech Ultrasonic Ranger Finder 16 - 600см.

### SX1507 4-канальный GPIO со сдвигом уровня со светодиодным драйвером (3E, 3F, 70, 71)
Самый низкий уровень напряжения в мире Semtech с переключателем GPIO со светодиодным драйвером для 4 каналов.

### SX1508 8-канальный GPIO с переключением уровня со светодиодным драйвером и механизмом клавиатуры (20-23)
Самый низкий уровень напряжения в мире Semtech с переключателем GPIO со светодиодным драйвером и клавиатурой для 8 каналов.

### SX1509 16-канальный GPIO с переключением уровня со светодиодным драйвером и механизмом клавиатуры (3E, 3F, 70, 71)
Самый низкий уровень напряжения в мире Semtech с переключателем GPIO со светодиодным драйвером и клавиатурой для 16 каналов.

### Общее устройство (03-77)
Обычное устройство I2C. Регистры можно настроить в зависимости от оборудования.

## Использование в скриптах
Поддерживаемые команды для `sendTo` в сценариях: `search`, `read` и `write`.

`search` принимает в качестве сообщения номер шины и возвращает строку JSON с массивом найденных адресов на шине.

`read` принимает в качестве сообщения объект, содержащий адрес и, необязательно, регистр и количество байтов для чтения. Возвращает буфер с прочитанными данными.

`write` принимает в качестве сообщения объект, содержащий адрес, данные в качестве буфера и, необязательно, регистр для записи. В случае успеха он возвращает записанный буфер.

### Примеры использования скрипта
```js
sendTo('i2c.0', 'search', 1, (ret) => {
    log('Ret: ' + ret, 'info');
});

sendTo(
    'i2c.0',
    'read',
    {
        address: 0x40,
        register: 0x02,
        bytes: 2,
    },
    (ret) => {
        log('Ret: ' + ret.inspect(), 'info');
    },
);

sendTo(
    'i2c.0',
    'write',
    {
        address: 0x40,
        register: 0x00,
        data: Buffer.from([0x44, 0x27]),
    },
    (ret) => {
        log('Ret: ' + ret.inspect(), 'info');
    },
);
```

## Совместимость
Совместимость проверена с Raspberry Pi 3 и 4B.

## Отчеты об ошибках и запросы функций
Пожалуйста, используйте репозиторий GitHub, чтобы сообщать об ошибках или запрашивать новые функции.

Если вам требуются отсутствующие устройства, укажите тип ИС (марка, модель, ...) и ее адрес (а), как указано в конфигурации адаптера.

## Разработка
### VS Code и Devcontainer
Этот репозиторий настроен так, что разработка может выполняться с использованием VS Code и Devcontainer. Просто откройте корневую папку этого репозитория с помощью VS Code и подтвердите переход на Devcontainer.

### Удаленный I2C
Если вы разрабатываете на настольном ПК и хотите протестировать I2C на SBC (например, Raspberry Pi), вы можете сделать следующее:

- Установите ioBroker на SBC с I2C
- Установите этот адаптер на SBC
- Настройте экземпляр адаптера на SBC вручную, чтобы он содержал параметр «serverPort» в «native»:

```json
  "native": {
    "busNumber": 1,
    "serverPort": 5555
  }
```

- Здесь не нужно настраивать какие-либо устройства I2C
- Добавьте экземпляр адаптера на рабочий стол ioBroker (или используйте Devcontainer, как описано выше)
- Настройте экземпляр адаптера на настольном ПК вручную, чтобы он содержал параметр clientAddress в параметре «native»:

```json
  "native": {
    "busNumber": 1,
    "clientAddress": "http://<your-ip-address>:5555/rpc"
  }
```

- Убедитесь, что вы используете правильный IP-адрес и порт (тот, который настроен на устройстве)
- Перезагрузите экземпляр адаптера на настольном ПК.
- Адаптер теперь будет выполнять все команды I2C на настроенном SBC, а не локально.
- Вы можете открыть настройки экземпляра адаптера на своем настольном ПК и сканировать устройства I2C, как на реальном SBC.

Имейте в виду, что сервер RPC полностью незащищен, поэтому его следует использовать только для разработки внутри защищенной сети!

## Спасибо
Этот проект основан на модуле NPM [i2c-автобус](https://www.npmjs.com/package/i2c-bus). Спасибо fivdi за его отличный модуль!

## Сторонние лицензии
### BME280
Код BME280 основан на https://github.com/skylarstein/bme280-sensor:

Лицензия MIT

Авторские права (c) 2016 Skylar Stein

Настоящим предоставляется бесплатное разрешение любому лицу, получившему копию этого программного обеспечения и связанных файлов документации («Программное обеспечение»), на работу с Программным обеспечением без ограничений, включая, помимо прочего, права на использование, копирование, изменение, объединение. , публиковать, распространять, сублицензировать и / или продавать копии Программного обеспечения и разрешать лицам, которым предоставляется Программное обеспечение, делать это при соблюдении следующих условий:

Вышеупомянутое уведомление об авторских правах и это уведомление о разрешении должны быть включены во все копии или существенные части Программного обеспечения.

ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ, ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ, НО НЕ ОГРАНИЧИВАЯСЬ, ГАРАНТИИ КОММЕРЧЕСКОЙ ПРИГОДНОСТИ, ПРИГОДНОСТИ ДЛЯ ОПРЕДЕЛЕННОЙ ЦЕЛИ И НЕЗАЩИТЫ ОТ ПРАВ. НИ ПРИ КАКИХ ОБСТОЯТЕЛЬСТВАХ АВТОРЫ ИЛИ ВЛАДЕЛЬЦЫ АВТОРСКИХ ПРАВ НЕ НЕСЕТ ОТВЕТСТВЕННОСТИ ЗА ЛЮБЫЕ ПРЕТЕНЗИИ, УБЫТКИ ИЛИ ДРУГИЕ ОТВЕТСТВЕННОСТЬ, БЫЛИ В РЕЗУЛЬТАТЕ ДОГОВОРА, ПРАКТИЧЕСКИХ ПРАВ ИЛИ ИНЫХ СЛУЧАЕВ, ВЫЯВЛЕННЫХ, ВНУТРИ ИЛИ В СВЯЗИ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ ИЛИ ИСПОЛЬЗОВАНИЕМ ИЛИ ДРУГИМИ ДЕЛАМИ ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ.

### ADS1x15
Код ADS1x15 основан на https://github.com/alphacharlie/node-ads1x15/blob/master/index.js

сам node-ads1x15 основан на https://github.com/adafruit/Adafruit_Python_ADS1x15

Лицензия MIT (MIT)

Авторские права (c) Adafruit Industries, 2016 г.

Настоящим предоставляется бесплатное разрешение любому лицу, получившему копию этого программного обеспечения и связанных файлов документации («Программное обеспечение»), на работу с Программным обеспечением без ограничений, включая, помимо прочего, права на использование, копирование, изменение, объединение. , публиковать, распространять, сублицензировать и / или продавать копии Программного обеспечения и разрешать лицам, которым предоставляется Программное обеспечение, делать это при соблюдении следующих условий:

Вышеупомянутое уведомление об авторских правах и это уведомление о разрешении должны быть включены во все копии или существенные части Программного обеспечения.

ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ, ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ, НО НЕ ОГРАНИЧИВАЯСЬ, ГАРАНТИИ КОММЕРЧЕСКОЙ ПРИГОДНОСТИ, ПРИГОДНОСТИ ДЛЯ ОПРЕДЕЛЕННОЙ ЦЕЛИ И НЕЗАЩИТЫ ОТ ПРАВ. НИ ПРИ КАКИХ ОБСТОЯТЕЛЬСТВАХ АВТОРЫ ИЛИ ВЛАДЕЛЬЦЫ АВТОРСКИХ ПРАВ НЕ НЕСЕТ ОТВЕТСТВЕННОСТИ ЗА ЛЮБЫЕ ПРЕТЕНЗИИ, УБЫТКИ ИЛИ ДРУГИЕ ОТВЕТСТВЕННОСТЬ, БЫЛИ В РЕЗУЛЬТАТЕ ДОГОВОРА, ПРАКТИЧЕСКИХ ПРАВ ИЛИ ИНЫХ СЛУЧАЕВ, ВЫЯВЛЕННЫХ, ВНУТРИ ИЛИ В СВЯЗИ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ ИЛИ ИСПОЛЬЗОВАНИЕМ ИЛИ ДРУГИМИ ДЕЛАМИ ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ.

### PCA9685
Код PCA9685 основан на https://github.com/adafruit/Adafruit_Python_PCA9685/blob/master/Adafruit_PCA968/PCA9685.py

Лицензия MIT (MIT)

Авторские права (c) Adafruit Industries, 2016 Автор: Тони ДиКола

Настоящим предоставляется бесплатное разрешение любому лицу, получившему копию этого программного обеспечения и связанных файлов документации («Программное обеспечение»), на работу с Программным обеспечением без ограничений, включая, помимо прочего, права на использование, копирование, изменение, объединение. , публиковать, распространять, сублицензировать и / или продавать копии Программного обеспечения и разрешать лицам, которым предоставляется Программное обеспечение, делать это при соблюдении следующих условий:

Вышеупомянутое уведомление об авторских правах и это уведомление о разрешении должны быть включены во все копии или существенные части Программного обеспечения.

ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ, ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ, НО НЕ ОГРАНИЧИВАЯСЬ, ГАРАНТИИ КОММЕРЧЕСКОЙ ПРИГОДНОСТИ, ПРИГОДНОСТИ ДЛЯ ОПРЕДЕЛЕННОЙ ЦЕЛИ И НЕЗАЩИТЫ ОТ ПРАВ. НИ ПРИ КАКИХ ОБСТОЯТЕЛЬСТВАХ АВТОРЫ ИЛИ ВЛАДЕЛЬЦЫ АВТОРСКИХ ПРАВ НЕ НЕСЕТ ОТВЕТСТВЕННОСТИ ЗА ЛЮБЫЕ ПРЕТЕНЗИИ, УБЫТКИ ИЛИ ДРУГИЕ ОТВЕТСТВЕННОСТЬ, БЫЛИ В РЕЗУЛЬТАТЕ ДОГОВОРА, ПРАКТИЧЕСКИХ ПРАВ ИЛИ ИНЫХ СЛУЧАЕВ, ВЫЯВЛЕННЫХ, ВНУТРИ ИЛИ В СВЯЗИ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ ИЛИ ИСПОЛЬЗОВАНИЕМ ИЛИ ДРУГИМИ ДЕЛАМИ ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ.

Также на основе: https://github.com/tessel/servo-pca9685/blob/master/index.js

Copyright 2014 Technical Machine, Inc. См. Файл COPYRIGHT в каталоге верхнего уровня этого дистрибутива.

Под лицензией Apache License версии 2.0 <LICENSE-APACHE или http://www.apache.org/licenses/LICENSE-2.0> или лицензии MIT <LICENSE-MIT или http://opensource.org/licenses/MIT> , на ваше усмотрение. Этот файл нельзя копировать, изменять или распространять, кроме как в соответствии с этими условиями.

## Changelog
<!--
	Placeholder for the next version (at the beginning of the line):
	### __WORK IN PROGRESS__
-->

### 1.2.0 (2021-03-02)

-   (UncleSamSwiss) Added support for MCP342x family (#44).
-   (UncleSamSwiss) Added proper error handling on all periodic I2C operations (#112).

### 1.1.1 (2020-11-29)

-   (UncleSamSwiss) Fixed issue with device search not working (#53).

### 1.1.0 (2020-11-05)

-   (UncleSamSwiss) Added support for SX1507, SX1508 and SX1509.
-   (UncleSamSwiss) Added support for MCP4725.
-   (UncleSamSwiss) Added support for HMC5883L and QMC5883L.
-   (UncleSamSwiss) Added support for Adafruit STEMMA Soil Sensor.
-   (UncleSamSwiss) Added support for INA219.
-   (UncleSamSwiss) Changed polling interval of ADS1x15 to milliseconds.
-   (UncleSamSwiss) Fixed several bugs.

### 1.0.1 (2020-10-27)

-   (UncleSamSwiss) Removed unneeded files in NPM package

### 1.0.0 (2020-10-27)

-   (UncleSamSwiss) Updated to the latest development tools and changed to the TypeScript language
-   (UncleSamSwiss) Rewrote entire UI in React with TypeScript

### 0.0.8 (2020-05-26)

-   (Peter Müller) Added support for Generic device.
-   (Peter Müller) Added support for `read` and `write` commands in scripts using `sendTo`.
-   (Peter Müller) Added support for interrupts on PCF8574, MCP23008, MCP23017 devices.

### 0.0.7 (2020-01-19)

-   (CC1337) Added support for PCA9685.

### 0.0.6 (2019-03-17)

-   (UncleSamSwiss) Added support for BME280.
-   (UncleSamSwiss) Added support for ADS1015 / ADS1115.

### 0.0.5 (2019-01-12)

-   (UncleSamSwiss) Added support for MCP23008.

### 0.0.4 (2018-07-23)

-   (UncleSamSwiss) Improved stability of MCP23017.
-   (Apollon77) Latest ioBroker utils and testing including node 10.

### 0.0.3 (2017-11-12)

-   (UncleSamSwiss) Added support for MCP23017.

### 0.0.2 (2017-07-30)

-   (UncleSamSwiss) Added support for inverting PCF8574 inputs and outputs.

### 0.0.1 (2017-07-27)

-   (UncleSamSwiss) Initial version

## License

Copyright 2020 UncleSamSwiss

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

See the License for the specific language governing permissions and
limitations under the License.
