---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translationFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/adapterref/iobroker.alexa2/README.md
title: ioBroker.alexa2
hash: scdTXz/4hoNS51L/vFpSFzGbFTare1wpyqrnVMKeKCg=
---
![Логотип](../../../en/adapterref/iobroker.alexa2/admin/alexa.png)

![Количество установок](http://iobroker.live/badges/alexa2-stable.svg)
![версия НПМ](http://img.shields.io/npm/v/iobroker.alexa2.svg)
![Загрузки](https://img.shields.io/npm/dm/iobroker.alexa2.svg)

# IoBroker.alexa2
![Тестирование и выпуск](https://github.com/Apollon77/iobroker.alexa2/workflows/Test%20and%20Release/badge.svg) [![Статус перевода](https://weblate.iobroker.net/widgets/adapters/-/alexa2/svg-badge.svg)](https://weblate.iobroker.net/engage/adapters/?utm_source=widget)

**Этот адаптер использует библиотеки Sentry для автоматического сообщения разработчикам об исключениях и ошибках кода.** Подробнее об отключении отчётов об ошибках см. в разделе [Документация по плагину Sentry](https://github.com/ioBroker/plugin-sentry#plugin-sentry)! Отчёты Sentry используются, начиная с версии js-controller 3.0.

Этот адаптер позволяет удаленно управлять устройствами Alexa (Amazon Echo).

Огромное спасибо soef за первую версию адаптера, а также Hauke и ruhr70 за идеи для их скриптов на форуме ioBroker (особенно в части обновлений медиа-контента)! Также огромное спасибо meicker за помощь в документировании всего этого и многочисленным пользователям форума ioBroker за поддержку в тестировании!

## Отказ от ответственности
**Все названия продуктов и компаний, а также логотипы являются товарными знаками™ или зарегистрированными® товарными знаками соответствующих владельцев. Их использование не подразумевает какой-либо связи с ними или их дочерними компаниями или их одобрения! Этот личный проект поддерживается в свободное время и не имеет коммерческой цели.** **ALEXA является товарным знаком AMAZON TECHNOLOGIES, INC.**

## Состояния и их значения:
В пространстве имен адаптера (например, alexa2.0) некоторые каналы создаются

### Alexa2.0
| Название штата | значение |
|----------------------|--------------------------------------------------------|
| Echo-Devices.* | Состояния каждого Echo-устройства см. ниже |
| История.* | Информацию об истории команд см. ниже |
| Устройства для умного дома.* | Состояния для каждого устройства умного дома и в целом см. ниже |
| info.* | Общая информация о состоянии адаптера |
| requestResult | Информация об ошибках для запросов TuneIn и устройств умного дома |

### Alexa2.0.Contacts.ContactId.*
Все контакты Alexa, которым можно отправлять текстовые сообщения, включая себя. После имени контакта добавляется специальный символ «(Я)».

| Название штата | значение |
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| #clearOwnMessages | Существует только в собственном контакте, и триггер удаляет все сообщения, отправленные ему (включая сообщения, отправленные ему через приложение или устройства!) |
| textMessage | Отправляет этот текст как сообщение пользователю. Он отображается на всех устройствах этого пользователя с «жёлтым кольцом» |

### Alexa2.0.Echo-Devices.CommandsAll.*
Команды, которые необходимо отправить на все устройства в учетной записи.

| Название штата | Значение | Комментарии |
|--------------------|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------|
| deviceStop | Остановить все действия на устройстве | Кнопка |
| deviceDoNotDisturb | Включить/выключить режим «Не беспокоить» для всех устройств. | true/false или число в секундах для включения (макс. 12 ч) или строка в формате «ЧЧ:ММ» до этого времени включения |

### Alexa2.0.Echo-Devices.Серийный номер.*
В разделе «echo-devices» для каждого устройства Amazon Echo указан его серийный номер. Не для каждого устройства отображаются все состояния. Каждое устройство имеет свои собственные состояния, описанные ниже:

### Alexa2.0.Echo-Devices.Серийный номер.Alarm.*
Настройки сигнализации (Wecker) для каждого устройства, если они доступны.

| Название штата | значение | ценность |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <id>.customVolume | Установите пользовательский уровень громкости для этого напоминания. Уровень громкости устанавливается за 2 секунды до срабатывания напоминания и сбрасывается на прежнее значение сразу после остановки таймера (или после того, как адаптер сочтет это срабатыванием!) — самое позднее через 120 секунд! Если пользовательский уровень громкости и время срабатывания совпадают, он будет восстановлен в конце! | Число 0..100 |
| <id>.date | Перезапишите дату существующего будильника, чтобы установить новую дату для этого будильника. Если у вас уже есть будильник, вы можете изменить дату здесь, просто переписав время в формате ГГГГ-ММ-ДД. Может не сработать при использовании настроек повторения несколько раз в день! | Вывод даты |
| <id>.delete | Кнопка удаления будильника | удалить со значением true |
| <id>.enabled | Показывает состояние тревоги и позволяет изменять его: Активировать тревогу при значении true - Деактивировать тревогу при значении false | true / false |
| <id>.musicEntity | Показывает информацию о треке, если этот будильник музыкальный | String или null |
| <id>.musicProvider | Показывает поставщика музыки, если этот будильник музыкальный | String или null |
| <id>.nextTriggerDate | Содержит момент времени следующего ожидаемого срабатывания в формате unix epoch в мс | Число |
| <id>.recurringDays | Показывает список настроенных дней, если у будильника есть повторяющиеся настройки | Американская нотация дней недели (например, MO,TU,WE,TH,FR,SA,SU) |
|<id> .recurringPattern | Показывает повторяющийся шаблон сигнала тревоги | 0 = один раз, без повторения<br> P1D = ежедневно<br> XXXX-WD = по будням<br> XXXX-WE = по выходным<br> XXXX-WXX-1 = каждый понедельник<br> XXXX-WXX-2 = каждый вторник<br> XXXX-WXX-3 = каждую среду<br> XXXX-WXX-4 = каждый четверг<br> XXXX-WXX-5 = каждую пятницу<br> XXXX-WXX-6 = каждую субботу<br> XXXX-WXX-7 = каждое воскресенье |
| <id>.snoozed | true, если будильник в данный момент отложен | true/false |
| <id>.sound | Содержит установленный звук для этого будильника. Можно изменить. Также возможно переключение между вводом звука музыки и «встроенными звуками». | ID из списка |
| <id>.time | Время срабатывания будильника. Перезапишите время существующего будильника, чтобы установить новое время для этого будильника. Если у вас уже есть будильник, вы можете изменить время здесь, просто перезаписав время в формате чч:мм:сс, секунды для установки не требуются. Может не сработать при использовании настроек повторения несколько раз в день! | Ввод времени |
| <id>.triggered | true, если будильник достигнут и сработал. Часы должны быть синхронизированы с Amazon и iobroker. Используйте это для запуска других действий сразу после наступления времени будильника | true / false |
| Новое | Данные для создания нового напоминания в виде строки в следующем формате, разделенные символом ;: «метка времени;[метка];[звук];[повторяющийся]. метка времени в формате unix в мс, метка в виде текста, звук в виде идентификатора звука, повторяющееся: пусто для однократного использования, «DAILY» для ежедневного использования или «WEEKLY=MO,TU,WE,TH,FR,SA,SU» со списком дней недели, разделенным запятыми. Поля в приведенном выше примере в скобках означают, что они необязательны! | Строка |
| сработал | Идентификатор последней сработавшей тревоги на этом устройстве | Идентификатор |

Если изменение будильника не работает, убедитесь, что момент времени срабатывания будильника находится в будущем. В таком случае изменение, например, «звука» будильника в прошлом не сработает!

### Alexa2.0.Echo-Devices.Серийный номер.Bluetooth.*
Здесь вы найдете все подключенные или известные устройства Bluetooth с MAC-адресами. Состояние каждого устройства:

| Название штата | значение |
|------------|----------------------------------------------------------------------------------------------------|
| подключено | Показывает текущее состояние подключения и разрешает подключение (значение true) или отключение (значение false) |
| разорвать пару | Кнопка для разрыва пары этого устройства с устройством Echo |

### Alexa2.0.Echo-Устройства.Серийный номер.Команды.*
С помощью команд вы можете запускать некоторые действия на вашем устройстве Alexa. Если вы используете их на устройстве с несколькими комнатами, то они выполняются независимо и *не будут* синхронизированы на отдельных устройствах!

| Название штата | значение | ценность |
|---------------|----------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|
| doNotDisturb | Включить/выключить режим «Не беспокоить» для этого устройства или группы. Значение также обновляется при обновлении конфигурации устройства из облака | true/false, или число секунд для включения (максимум 12 ч), или строка в формате «ЧЧ:ММ» до момента включения |
| flashbriefing | Брифинг за 100 секунд - новости и т. д. | Кнопка |
| доброе утро | Доброе утро от Алексы... | Кнопка |
| забавный факт | Интересный факт от Alexa ... (пока только в США) | Кнопка |
| шутка | Шутка от Алексы... | Кнопка |
| очистка | Воспроизводит звук «гонга», как при начале/конце режима прослушивания... | Кнопка |
| curatedtts | Случайное предложение из выбранной области от Alexa ... | Текст (разрешено: «до свидания», «подтверждения», «доброе утро», «комплименты», «день рождения», «спокойной ночи», «iamhome») |
| singasong | Алекса поёт песню... | Кнопка |
| говорить | Alexa произносит то, что вы здесь вводите... | Ввод текста |
| speakvolume | Отрегулируйте громкость речи Alexa, эта громкость устанавливается до начала речи и сбрасывается после нее | 0-100 |
| навык | Запустить определенный навык | ID навыка как строку |
| skillYours | запуск определенного навыка — предварительно заполнено «Вашими навыками», как отображается в приложении Alexa | ID навыка в виде строки |
| telltory | Алекса рассказывает историю | Кнопка |
| трафик | Новости о дорожном движении | Кнопка |
| погода | Новости погоды | Кнопка |
| deviceStop | Остановить все действия на устройстве | Кнопка |
| уведомление | Отправить текстовое уведомление владельцу устройства | Текст, при желании укажите заголовок "title;text" |
| объявление | Воспроизвести объявление (как в речевой рекламе, но с Bing перед текстом)<br> *Примечание: будет работать только в том случае, если активированы оповещения (для этого устройства) и устройство не находится в режиме «не беспокоить»* | Текст |
| ssml | Озвучить XML-строку SSML<br> *Примечание: будет работать только в том случае, если активированы оповещения (для этого устройства) и устройство не находится в режиме «не беспокоить»* | Текст |
| textcommand | Отправьте Алексе текстовую команду. Используйте только текст (например, 3 -> три и т.п., иначе Алекса может отреагировать неправильно!) | Текст |
| звук | Воспроизвести звук на устройстве. | Текст |

Подробная информация. Озвучивание и объявления: Введите здесь то, что вы хотите, чтобы Алекса произнесла. Вы также можете настроить громкость Алексы, указав процентное значение перед текстом.

Пример: 10;Алекса произносит Алексу с 10% громкостью, а 100;Алекса произносит Алексу с 100% громкостью.
Обычно в одной команде «Озвучивание» можно отправить не более 250 символов. Используя точку с запятой, можно написать столько символов, сколько нужно, разделяя их точками с запятой.
Затем Алекса будет произносить текст один за другим с небольшим перерывом. Вы также можете использовать громкость вместе с более чем 255 блоками, указав #Громкость;#Блок1;#Блок2 и т.д. Указанная здесь громкость будет использоваться поверх заданной громкости.

Частично также работают звуки из https://developer.amazon.com/en-US/docs/alexa/custom-skills/ask-soundlibrary.html. Укажите в Speak или SSML как `<audio src="soundbank://soundlibrary/animals/amzn_sfx_bear_groan_roar_01"/>`. Подробности и обсуждение на https://forum.iobroker.net/topic/27509/ssml-audio

### Alexa2.0.Echo-Devices.Serialnumber.FireTVCommands.*
Если устройство — Amazon FireTV, то вы можете использовать следующие команды:

| Название штата | значение | ценность |
|--------------|--------------------------|--------|
| turnOn | Включить FireTV и телевизор | Кнопка |
| turnOff | Выключить FireTV и телевизор | Кнопка |
| videoPause | Приостановить воспроизведение видео | Кнопка |
| videoResume | Возобновить текущее видео | Кнопка |
| navigationHome | Перейти на главную | Кнопка |

### Alexa2.0.Echo-Devices.Serialnumber.Info.*
Информация об устройстве Alexa

| Название штата | значение | ценность |
|-------------------|---------------------------------------------------------------------------------------------|---------------------------|
| возможности | возможности устройства Alexa | Информация |
| deviceType | тип устройства от Amazon | Информация |
| deviceTypeString | Тип устройства как строка | Информация |
| isMultiroomDevice | Является ли устройство multiroom устройством? Multiroom — это группа виртуальных устройств | Информация, true / false |
| isMultiroomMember | Является членом Multiroom — если true, устройство входит в группу устройств multiroom | Информация, true / false |
| MultiroomParents | Если это устройство входит в группу устройств multiroom, это состояние показывает родительское групповое устройство | Информация |
| имя | Название устройства Alexa | Информация |
| SerialNumber | Серийный номер устройства Alexa |

### Alexa2.0.Echo-Devices.Серийный номер.Музыкальный-провайдер.*
Скажите Alexa напрямую воспроизвести музыку или плейлист от поддерживаемых музыкальных провайдеров. Поддерживаются: My Library, Amazon Music, Tune In. Вы также можете включить в фразу название группы устройств мультирума для воспроизведения в этой группе (например, «SWR3 auf Erdgeschoss»).

| Название штата | значение | ценность |
|-----------------------|------------------------------------|------------|
| Amazon-Music | Фраза для воспроизведения с Amazon Music | Ввод текста |
| Amazon-Music-Playlist | Плейлист для воспроизведения с Amazon Music | Ввод текста |
| Моя библиотека | Фраза для воспроизведения с помощью «Моей библиотеки» | Ввод текста |
| My-Library-Playlist | Плейлист для воспроизведения с помощью My Library | Ввод текста |
| Tune-In | Фраза для воспроизведения с помощью Tune In | Ввод текста |
| Tune-In-Playlist | Плейлист для воспроизведения с Tune In | Ввод текста |

### Alexa2.0.Echo-Devices.Серийный номер.Player.*
Состояния для управления воспроизведением устройства и просмотра текущего состояния и информации о медиафайлах

| Название штата | значение | ценность |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| allowNext | Разрешено ли действие «Далее/Вперед»? | Информация |
| allowPlayPause | Разрешено ли действие «Воспроизведение/Пауза»? | Информация |
| allowPrevious | Разрешено ли действие «Предыдущее»? | Информация |
| allowRepeat | Можно ли использовать функцию Repeat? | Информация |
| allowShuffle | Можно ли использовать функцию Shuffle? | Информация |
| ContentType | текстовое поле для ввода желаемого контента для воспроизведения на этом устройстве | Информация |
| controlForward | Кнопка для запуска команды игрока «вперед» (30 с) | Кнопка |
| controlNext | Кнопка для вызова команды «Далее» игрока | Кнопка |
| controlPause | Кнопка для вызова команды «пауза» проигрывателя | Кнопка |
| controlPlay | Кнопка для запуска команды «воспроизведение» проигрывателя | Кнопка |
| controlPrevious | Кнопка для вызова команды «предыдущая» игрока | Кнопка |
| controlRepeat | Кнопка для запуска команды «повторить» проигрывателя | true / false |
| controlRewind | Кнопка для запуска команды «перемотка назад» проигрывателя (30 с) | Кнопка |
| controlShuffle | Включить или отключить режим случайного воспроизведения для проигрывателя | true / false |
| currentAlbum | Текущий альбом, который сейчас воспроизводится | Информация |
| currentArtist | Текущий исполнитель, который сейчас играет | Информация |
| currentState | Если воспроизведение -> true, иначе false | true / false |
| currentTitle | Текущий воспроизводимый фильм | Информация |
| imageURL | URL к изображению альбома | Информация |
| mainArtURL | URL-адрес текущего основного изображения | Информация |
| mediaId | идентификатор текущего воспроизводимого медиа-контента (обычно queueID:<number> | String, можно настроить на переход к предоставленному идентификатору медиа-контента |
| mediaLength | Длина текущего заголовка | Информация |
| mediaLengthStr | длина активного носителя как (ЧЧ:)ММ:СС | Информация |
| mainProgress | прошедшее время активного носителя | Информация |
| mainProgressPercent | прошедшее время активного носителя в процентах | Информация |
| mediaProgressStr | прогресс активных медиа как (ЧЧ:)ММ:СС | Информация |
| миниАртУрл | Ссылка на искусство (мини) | Информация |
| отключен звук | состояние «MUTE» | Информация, true/false, громкость = 0 считается отключенной |
| playingInGroup | Играется ли эта среда в группе? | Информация |
| playingInGroupId | ID играющей группы | Информация |
| providerID | ID текущего музыкального провайдера | Информация |
| providerName | Название текущего музыкального провайдера | Информация |
| качество | название качества текущего носителя (может быть пустым) | Информация |
| qualityCodec | Кодек текущего носителя (может быть пустым) | Информация |
| qualityDataRate | скорость передачи данных (кбит/с) текущего носителя (может быть пустым) | Информация |
| qualitySampleRate | частота дискретизации (Гц) текущего носителя (может быть пустой) | Информация |
| queueId | идентификатор очереди текущего плейлиста | Информация |
| radioStationId | Идентификатор радиостанции TuneIn | Информация |
| сервис | название текущего музыкального сервиса | Информация |
| TuneIn-Station | текстовое поле для ввода названия станции для воспроизведения на этом устройстве. Также можно ввести номер станции (s123456...), идентификатор шоу/подкаста (p1234567...) или идентификатор темы (t123456789...) | Ввод текста |
| громкость | Громкость воспроизведения. Можно ввести значение от 0 до 100% | ВВОД Громкость |

### Alexa2.0.Echo-Devices.Серийный номер.Настройки.*
Здесь вы найдете некоторые настройки устройства.

| Название штата | значение | ценность |
|----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
| ringNotificationsEnabled | Показывает, включены ли уведомления о звонках, и позволяет изменить это (true/false). Статус обновляется из облака с интервалом настройки устройства |
| notificationVolume | Громкость уведомлений, установленная для устройства. Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | число 0..100 |
| ascendingAlarmState | Возрастающее состояние тревоги, установленное для устройства. Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | Логическое значение |
| auxPort-*-Direction | Направление AuxPort (если поддерживается). Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено. | «INPUT» или «OUTPUT» |
| connectedSpeaker | Динамик используется для выхода устройства. Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | "InternalSpeaker", "Bluetooth" или "Aux" (если поддерживается устройством! Проверьте приложение) |
| defaultAlarmNotificationSound | Звук будильника по умолчанию, установленный для устройства. Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | ID из списка |
| defaultTimerNotificationSound | Звук таймера по умолчанию, установленный для устройства. Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | ID из списка |
| displayAdaptiveBrightnessEnabled | Включена ли адаптивная регулировка яркости дисплея устройства? Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | true/false |
| displayEnabled | Включено ли отображение устройства? Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может быть изменено | true/false |
| displayBrightness | Яркость дисплея. Значение загружается один раз при запуске адаптера и затем не синхронизируется с облачными сервисами, но может изменяться | 0..100% |
| equalizerBass | Настройка басов эквалайзера. Значение обновляется при изменении, если включено push-соединение | Номер |
| equalizerMidRange | Настройка средних частот эквалайзера. Значение обновляется при изменении, если включено push-соединение | Номер |
| equalizerTreble | Настройка высоких частот эквалайзера. Значение обновляется при изменении, если включено push-соединение | Номер |

### Alexa2.0.Echo-Devices.Серийный номер.Напоминание.*
Настройки напоминаний (Erinnerungen) для каждого устройства, если они доступны.

| Название штата | значение | ценность |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <id>.customVolume | Установите пользовательский уровень громкости для этого напоминания. Уровень громкости устанавливается за 2 секунды до срабатывания напоминания и сбрасывается на прежнее значение сразу после остановки таймера (или после того, как адаптер сочтет это срабатыванием!) — самое позднее через 120 секунд! Если пользовательский уровень громкости и время срабатывания совпадают, он будет восстановлен в конце! | Число 0..100 |
| <id>.date | Перезапишите дату существующего будильника, чтобы установить новую дату для этого будильника. Если у вас уже есть будильник, вы можете изменить дату здесь, просто переписав время в формате ГГГГ-ММ-ДД. Может не сработать при использовании настроек повторения несколько раз в день! | Вывод даты |
| <id>.delete | Кнопка удаления будильника | удалить со значением true |
| <id>.enabled | Показывает состояние тревоги и позволяет изменять его: Активировать тревогу при значении true - Деактивировать тревогу при значении false | true / false |
| <id>.nextTriggerDate | Содержит момент времени следующего ожидаемого срабатывания в формате unix epoch в мс | Число |
| <id>.recurringDays | Показывает список настроенных дней, если у будильника есть повторяющиеся настройки | Американская нотация дней недели (например, MO,TU,WE,TH,FR,SA,SU) |
|<id> .recurringPattern | Показывает повторяющийся шаблон сигнала тревоги | 0 = один раз, без повторения<br> P1D = ежедневно<br> XXXX-WD = по будням<br> XXXX-WE = по выходным<br> XXXX-WXX-1 = каждый понедельник<br> XXXX-WXX-2 = каждый вторник<br> XXXX-WXX-3 = каждую среду<br> XXXX-WXX-4 = каждый четверг<br> XXXX-WXX-5 = каждую пятницу<br> XXXX-WXX-6 = каждую субботу<br> XXXX-WXX-7 = каждое воскресенье |
| <id>.snoozed | true, если будильник в данный момент отложен | true/false |
| <id>.sound | Содержит установленный звук для этого будильника. Можно настроить | ID из списка |
| <id>.time | Время срабатывания будильника. Перезапишите время существующего будильника, чтобы установить новое время для этого будильника. Если у вас уже есть будильник, вы можете изменить время здесь, просто перезаписав время в формате чч:мм:сс, секунды для установки не требуются. Может не сработать при использовании настроек повторения несколько раз в день! | Ввод времени |
| <id>.triggered | true, если будильник достигнут и сработал. Часы должны быть синхронизированы с Amazon и iobroker. Используйте это для запуска других действий сразу после наступления времени будильника | true / false |
| Новое | Данные для создания нового напоминания в виде строки в следующем формате, разделенном символом ;, например, «метка времени;метка;[звук];[повторяющийся]. метка времени в виде метки времени Unix в мс или текста типа «ЧЧ:ММ», метка в виде текста (обязательно), звук в виде идентификатора звука, повторяющееся может быть пустым для однократного использования, «DAILY» для ежедневного использования или «WEEKLY=ПН,ВТ,СР,ЧТ,ПТ,СБ,ВС» со списком дней недели, разделенным запятыми. Для полной гибкости повторяющееся также может быть JSON-объектом со всеми передаваемыми данными. Поля в приведенном выше примере в скобках означают, что они необязательны! | Строка |
| сработал | Идентификатор последней сработавшей тревоги на этом устройстве | Идентификатор |

Если изменение напоминания не работает, убедитесь, что момент времени напоминания находится в будущем. В таком случае изменение, например, «звука» напоминания в прошлом _не_ сработает!

### Alexa2.0.Echo-Устройства.Серийный номер.Процедуры.*
Обзор процедур, настроенных в приложении Alexa. Созданные вами процедуры имеют серийный номер, на Amazon они отображаются как «преднастроено:...». Каждую процедуру можно запустить однократно, нажав кнопку.

| Название штата | значение | ценность |
|------------------------------------|-----------------|--------|
| Серийное или внутреннее имя процедуры | имя процедуры | Кнопка |

### Alexa2.0.Echo-Устройства.Серийный номер.Таймер.*
Вы можете запустить один или несколько таймеров на каждом устройстве Alexa. Поскольку таймеры очень динамичны, не нужно создавать дополнительные объекты, как в случае с будильником или напоминаниями, но существует способ получать информацию о срабатывании таймера.

| Название штата | значение | ценность |
|-----------------|--------------------------------------------------------------------------------------------------------------|------------|
| activeTimerList | Массив JSON со списком активных таймеров, содержащих ID, метку и точку времени срабатывания в виде метки времени Unix в мс | Массив JSON |

| nextTimeDate | Содержит момент времени следующего ожидаемого срабатывания в формате unix epoch в мс | Число | Число

| nextTimerId | Идентификатор следующего таймера для срабатывания | String |
| stopTimerId | Элемент управления с идентификатором таймера для остановки таймера (также останавливает, если таймер в данный момент звонит!) | String |
| сработал | Сработал таймер - на самом деле это "nextTimerId" | true/false |

**Обратите внимание: важно, чтобы часовой пояс хоста iobroker соответствовал вашему местному часовому поясу, в противном случае определение времени срабатывания может быть неверным!**

### Alexa2.0.Echo-Devices.Serialnumber.online
Подключено ли это устройство Alexa к сети и облаку Amazon?

| Название штата | значение | ценность |
|------------|------------------------|--------------|
| онлайн | Устройство подключено к сети? | Верно / Неверно |

### Alexa2.0.История
| Название штата | значение | ценность |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| #trigger | Кнопка для получения новой истории (более актуальной, чем временная метка в creationTime), необходима только в том случае, если не используется push-соединение или когда отключен автоматический запрос | Кнопка |
| cardContent | Дополнительная информация, отображаемая в Alexa-App/Echo Show | Информация |
| cardJson | Дополнительная информация, показанная в Alexa-App/Echo Show в формате JSON | Информация |
| creationTime | дата этой записи в истории, новые записи в истории учитываются только после этой временной метки | Информация |
| domainApplicationId | Дополнительная информация, например Skill-ID или тому подобное, необязательно | Информация |
| domainApplicationName | Дополнительная информация, например, название навыка и т. п. (необязательно) | Информация |
| json | JSON данных последней команды, чтобы иметь возможность обрабатывать всю информацию, например, в собственных JavaScript-файлах | JSON |
| имя | Имя устройства, получившего последний запрос | Информация |
| serialNumber | Серийный номер устройства, получившего последний запрос | Информация |
| status | Статус последней команды для Alexa | SUCCESS / FAULT / DISCARDED_NON_DEVICE_DIRECTED_INTENT; последняя команда генерируется при активации устройства путем произнесения слова пробуждения или когда устройство отклонило ввод как «не для меня» |
| резюме | текст/сводка/действие, полученные устройством | Информация |

### Alexa.0.Умные-домашние-устройства
Включает все устройства умного дома, известные Alexa на основе ваших навыков. Для всех известных устройств указано следующее:

| Название штата | значение | ценность |
|-----------------|--------------------------------------------------------------------------------------------|--------|
| deleteAll | удаляет все устройства умного дома из Alexa, аналогично кнопке в приложении Alexa | Кнопка |
| discoverDevices | находит новые устройства умного дома, аналогично кнопке в приложении Alexa | Кнопка |
| queryAll | запрашивает все устройства, отображается только в том случае, если хотя бы одно устройство способно получить информацию | Кнопка |

### Alexa.0.Умные-Домашние-Устройства.СерийныйНомер.*
| Название штата | значение | ценность |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
| #delete | удалить устройство умного дома из Alexa | Кнопка |
| #enabled | Активно ли устройство умного дома? Состояние и управление для включения/выключения. Состояние будет синхронизировано с облаком с тем же интервалом, что и данные устройства умного дома. | true / false |
| #includeInAllQuery | Следует ли включать это устройство при запросе всех состояний устройства? | true / false |
| #query | запрос данных для этого устройства, отображается только в том случае, если устройство/навык умного дома поддерживает извлечение информации | Кнопка |
| активны | отображаются для сцен, когда их можно активировать/деактивировать | true / false |
| powerState | Включить/выключить питание | изменяемо, true/false |
| ... | Еще больше возможных состояний в зависимости от типа устройства умного дома | Информационное или изменяемое :-) |

**-> Специальные состояния для цветных/световых устройств**

| Название штата | значение | ценность |
|--------------------------|-------------------------------------------------------------------------|--------------------------------|
| яркость | яркость света HUE | изменяема 0-100% |
| цвет-Яркость | яркость для определения цвета (вместе с оттенком и насыщенностью, HSV) | Информация, 0-1% |
| color-hue | значение оттенка цвета (вместе с яркостью и насыщенностью, HSV) | Информация, 0-360° |
| насыщенность цвета | насыщенность цвета (вместе с яркостью и оттенком, HSV) | Информация, 0-1 |
| colorRGB | RGB-код фактического цвета, построенный на основе значений color-* | Информация, #rrggbb |
| colorName | Название цвета, определенное Alexa - фиксированные значения | можно изменить, чтобы задать цвет, 0-144 |
| colorTemperatureInKelvin | Цветовая температура в градусах Кельвина | Информация, 1000–10000К |
| colorTemperatureName | Название цветовой температуры, определенное Alexa - фиксированные значения | можно изменить, 0-18 |

Параметр #brightness позволяет регулировать яркость освещения, а #colorName — выбирать один предустановленный цвет (0–144). Для параметра HUE Ambient Light можно выбрать одно из 19 значений от 0 до 18 в параметре #colorTemperatureName. Все источники света можно включать и выключать с помощью #powerState.

### Alexa2.0.Info.*
| Название штата | значение | ценность |
|------------|-------------------------------------------------------------------------------------|-----------------------------|
| подключение | Если подключение к Alexa в порядке | Информация -> правда / ложь |
| cookie | Файл cookie Alexa, используется с несколькими внешними скриптами, которым также требуется доступ к API Alexa | Информация |
| csrf | CSRF Alexa, использование с несколькими внешними скриптами, которым также требуется доступ к API Alexa | Информация |

## Установка
Как обычно, используется стабильный репозиторий, последний репозиторий или используются опции «Установить» ioBroker с GitHub.

## Отправка последовательностей команд устройству Alexa через сообщения
Все команды устройствам Alexa можно отправлять через адаптер как отдельным устройствам, так и группам. Адаптер поддерживает отправку этих команд и, при необходимости, объединяет их для установки определённой громкости перед голосовым выводом и восстановления исходной громкости после него.

Если вы хотите отправлять пользовательские последовательности на устройства Alexa, вы можете создать процедуру и запускать ее также через состояния.

Если этого недостаточно, начиная с версии 3.14.0 адаптер предлагает способ отправки команд через сообщения.

Вы предоставляете структуру массива, которая будет преобразована в команды. Для одного элемента массива существует два типа параметров:

**Команда**

```json
{
    "command": "speak", // command like the state name in Commands states
    "value": "This is a test speak.", // value like value you set on state
    "device": "..." // optional: serialNumber of the device to send this command to
}
```

**Определение последовательности**

```json
{
    "sequenceType": "...", // "SerialNode" or "ParallelNode"
    "nodes": [...] // array of commands or sequences
}
```

Отправка сообщения, например, с использованием адаптера JavaScript выглядит так:

```javascript
adapter.sendTo(
    "alexa.0", // target
    "sendSequenceCommand", // command
    { // value
        "deviceSerialNumber": "...", // Serial number of one device to get Meta data which will be used if no device is pecified on the commands
        "sequenceNodes": [...], // list of sequences or commands
        "sequenceType": "SerialNode" // "SerialNode" or "ParallelNode" for the provided sequenceNodes on main level. Default is "SerialNode"
    }, (err, res) => {
        console.log(err);
        console.log(JSON.stringify(res));
    }
);
```

Когда команды выполняются параллельно как "ParallelNode", что, в основном, имеет смысл для отправки команд на разные устройства. Команды как "SerialNode" выполняются одна за другой — **об этом заботится Amazon, а не адаптер!**

Возможна такая структура:

```json
... // use ParallelNode on main level
"sequenceNodes": [
    {
        "sequenceType": "SerialNode",
        "nodes": [
            {
                "command": "speak",
                "value": "This is a test speak.",
                "device": "DeviceA"
            },
            {
                "command": "speak",
                "value": "This is a second test speak.",
                "device": "DeviceA"
            }
        ]
    },
    {
        "sequenceType": "SerialNode",
        "nodes": [
            {
                "command": "speak",
                "value": "This is a test speak.",
                "device": "DeviceB"
            },
            {
                "command": "speak",
                "value": "This is a second test speak.",
                "device": "DeviceB"
            },
            {
                "sequenceType": "ParallelNode",
                "nodes": [
                    {
                        "command": "flashbriefing",
                        "device": "DeviceC"
                    },
                    {
                        "command": "flashbriefing",
                        "device": "Device B"
                    }
                ]
            }
        ]
    }
]

```

## Поиск неисправностей
### Проблема с определением файлов cookie при двухфакторной аутентификации по SMS
Если вы всё ещё используете двухфакторную аутентификацию (2FA) через SMS/электронную почту, этот метод может не работать. Пожалуйста, обновите метод 2FA/OTP в настройках Amazon до актуального! Если он не работает, может также отображаться ошибка 404/страница не найдена. Также проверьте и обновите настройки одноразовых паролей!

### Приложение Alexa открывается, когда я пытаюсь войти в систему
Если вы открываете URL-адрес прокси-сервера с мобильного устройства, на котором также установлено приложение Alexa, он может не работать, поскольку Amazon может открыть приложение Alexa. Поэтому, пожалуйста, используйте устройство или компьютер, на котором приложение Alexa не установлено!

### Мне показывается страница с QR-кодом, который нужно отсканировать.
Если вы видите страницу с сообщением о том, что «alexa.amazon.xx устарел» и вам следует использовать приложение Alexa, а при вводе URL-адреса прокси-сервера отображается QR-код, то это означает, что вы вызываете URL-адрес прокси-сервера с другим IP-адресом/доменным именем, чем тот, который вы указали в настройках «собственный IP-адрес прокси-сервера», или вы изменили IP-адрес, указанный в конфигурации адаптера.

Настройка «собственный IP» **должна** совпадать с IP/доменным именем, которое вы используете для вызова URL-адреса прокси-сервера!

### Проблемы с определением cookie-файлов через электронную почту/пароль
Иногда Amazon применяет нестандартные проверки при обнаружении нежелательного трафика при входе в систему.
Это может привести к необходимости ввода капчи для входа в систему.
В большинстве случаев на эту капчу нужно ответить один раз, и после этого вход в систему будет работать без капчи.

Когда вам нужно ответить на такую капчу, то попробуйте сделать следующее:

* Используйте распространенный браузер (например, Chrome)
* отключите Javascript!
* удалите все файлы cookie, которые могут существовать для Amazon, или используйте режим «Приватный»/«Инкогнито» в браузере
* звоните https://alexa.amazon.de
* вы должны получить форму входа (обычно отображается в старых мобильных браузерах)
* войдите туда, используя свои учетные данные Amazon, где зарегистрирован Echo/Alexa
* Возможно, вам придется дважды войти в систему или решить капчу
* В конце вы должны увидеть "https://alexa.amazon.de/spa/index.html" в качестве URL, но без какого-либо реального контента (т.к. JS все еще отключен), НО ЭТО АБСОЛЮТНО НОРМАЛЬНО!!!!
* теперь попробуйте получить cookie еще раз
* Если это все еще не работает, повторите попытку и проверьте User-Agent и Accept-Language в вашем браузере и используйте их в адаптере при следующей попытке.

Кроме того, Accept-Language-Header (по умолчанию «de-DE») должен соответствовать вашему языку/языку браузера/языку страницы Amazon, на которую вы входите.

Вы также можете попробовать изменить User-Agent и использовать тот, который больше соответствует типу вашей системы.
Например, использование «Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, как Gecko) Chrome/51.0.2704.103 Safari/537.36» в качестве User-Agent, как сообщается, работает лучше при работе ioBroker в системе Linux.

Вы можете переопределить все эти параметры в конфигурации адаптера.

### Push-соединения не подключаются
Иногда может случиться, что из-за слишком большого количества попыток подключения Amazon блокирует конечную точку push-подключения для определенного IP-адреса и «устройства».

Если Push-соединение так и не устанавливается, то можно попробовать использовать следующее:

* удалить экземпляр адаптера
* проверьте, есть ли файлы типа /opt/iobroker/node_modules/iobroker.alexa2/formerDataStore*.json - если они есть, удалите их
* добавить новый экземпляр и получить новый cookie

Тогда это должно снова сработать.

### У меня слишком много устройств App/«This device» в моем списке Echo-устройств
Адаптер считывает данные Amazon. Иногда в этом списке остаются неиспользуемые и старые приложения или другие подключения.
Чтобы очистить этот список, необходимо зайти на сайт Amazon и удалить устройства.

Ссылка: https://www.amazon.de/hz/mycd/digital-console/devicedetails?deviceFamily=ALEXA_APP

После удаления неиспользуемого устройства перезагрузите адаптер, чтобы удалить его и там.

### 🌍 Конфигурация Amazon для конкретного региона
У некоторых пользователей могут возникать сбои при первой настройке адаптера.
Часто это происходит из-за того, что адаптер **предварительно настроен для немецкого региона Amazon (amazon.de)**.
Если ваша учётная запись Alexa зарегистрирована на другой торговой площадке Amazon, необходимо обновить несколько настроек, чтобы адаптер взаимодействовал с правильными региональными конечными точками.

Если эти значения не скорректированы, аутентификация и файлы cookie могут работать, но при извлечении устройств возникнут сбои, что приведет к ошибкам запуска адаптера и получению сигнала завершения TERMINATE_YOURSELF.

Чтобы исправить региональные конечные точки, перейдите в `Instances > alexa2.x > Settings > Cookie` и настройте значения, как указано ниже.

| Регион / Страна | Базовый URL-адрес Alexa | Принятый язык | URL-адрес cookie Amazon |
|------------------|-----------------------|------------------|--------------------|
| **Франция** 🇫🇷 | `alexa.amazon.fr` | `fr-FR` | `amazon.fr` |
| *(Добавить еще...)* | | | |

Если вашего региона нет в списке и вы узнали его значение, не стесняйтесь дополнить эту документацию своими открытиями.

## Changelog
<!-- ### __WORK IN PROGRESS__ -->
### 3.27.4 (2025-11-06)
* (@Apollon77) Adjusts authentication check to recent Amazon changes

### 3.27.3 (2025-07-15)
* (Apollon77) Adjust Lists to recent Amazon changes
* (Apollon77) Adjust retrieving the Smart home device list to recent Amazon changes
* (Apollon77) Delete all ioBroker originated Smart Home devices because not controllable anyway
* (Apollon77) Adjust usage of some deprecated js-controller methods

### 3.26.7 (2024-10-24)
* (Apollon77) Fix Sentry integration

### 3.26.6 (2024-10-20)
* (simatec) Responsive Design added

### 3.26.5 (2024-04-16)
* (Apollon77) Adjust History query to recent Amazon changes

### 3.26.4 (2024-01-25)
* (Apollon77) Removed Weblink
* (Apollon77) Adjust History query to recent Amazon changes

### 3.26.3 (2023-11-25)
* (Apollon77) Fixed the proxy login process

### 3.26.2 (2023-11-24)
* (Apollon77) Removed infos how to get cookies manually because no longer available
* (Apollon77) Optimized Admin configuration order of settings for history
* (Apollon77) Fixed some crash cases reported by Sentry
* (Diginix/Apollon77) Added some more device types

### 3.26.1 (2023-11-08)
* (Apollon77) Fix missing text in Admin Config

### 3.26.0 (2023-11-08)
* (Apollon77) Automatically query of activity/history needs to be enabled manually (if you need it!)

### 3.25.5 (2023-10-29)
* (Apollon77) Optimize activity detection to process all relevant entries in all cases

### 3.25.4 (2023-10-27)
* (Apollon77) Optimize activity detection to process all relevant entries and not just the last one

### 3.25.3 (2023-10-27)
* (Apollon77) Adjust History update to work with recent Amazon changes

### 3.25.2 (2023-09-12)
* (Apollon77) Optimize reconnection handling for push connections

### 3.25.1 (2023-09-09)
* IMPORTANT: Minimum required Node-js version is 16 now!
* (Apollon77) Updated the Push connection after Amazon technology changes
* (Apollon77) Added some more device types

### 3.24.1 (2023-08-08)
* (Apollon77) Work around Amazon changes that affected all functions over the Push connection
* (Apollon77) Some smaller fixes and adjustments

### 3.23.2 (2022-11-30)
* (Apollon77) Prioritize real devices higher than app devices when serialnumbers overlap

### 3.23.1 (2022-11-26)
* (Apollon77) Enhance checks when changing smart device values
* (Apollon77) Try to prevent Amazon rate limiting (again)

### 3.21.0 (2022-11-03)
* IMPORTANT: Because of rate limits by Amazon, I decided to remove the update of smart home device values in intervals because it seems to produce too much load in Skills and Amazon systems.
* (Apollon77) Optimizes loading of smart home device states
* (Apollon77) Fixed issue with enabling/disabling of Alarms in combination with non-default music for the alarm
* (Apollon77) Prevented that Timers or Alarms that are long in the future to trigger their trigger state too early
* (Apollon77) Fixed deleting own user Messages state
* (Apollon77) Already request Notification updates when history registered a Notification action and do not wait for Push info to come in

### 3.20.1 (2022-10-29)
* (Apollon77) make sure caching works correctly with multiple instances of the adapter

### 3.20.0 (2022-10-29)
* (Apollon77) Increase minimum interval for requesting smart home device data to 15 minutes (900s) because of Amazon rate limits. Please do not try to work around it!
* (Apollon77) Cache Smart home device list and data to prevent too many requests when restarting adapter in short intervals and to prevent deleted smart home devices also on further rate limit issues

### 3.19.10 (2022-10-27)
* (Apollon77) Fix issue in retry handling when rate limit exceeded is returned by Amazon
* (Apollon77) Do not clean up Smart Home Device objects for now - delete manually if you remove a device

### 3.19.9 (2022-09-12)
* (Apollon77) Receive the correct player status again when musik is stopped

### 3.19.8 (2022-09-07)
* (Apollon77) Add safeguard for too high intervals

### 3.19.7 (2022-08-19)
* (Apollon77) Fix doNotDisturb when using a time string

### 3.19.6 (2022-08-18)
* (Apollon77) Fix doNotDisturb when using a time string

### 3.19.5 (2022-08-09)
* (Apollon77) Fix doNotDisturb for groups

### 3.19.4 (2022-08-07)
* (Apollon77) Prevent unwanted device Name updates

### 3.19.3 (2022-08-07)
* (Apollon77) Fix crash check with multiple adapter instances

### 3.19.2 (2022-08-06)
* (Apollon77) Fix Alarm creation when just providing time and it is for next day

### 3.19.1 (2022-08-04)
* (Apollon77) Fix retry handling

### 3.19.0 (2022-08-04)
* (Apollon77) Preserve Names as soon as it is an App type in general
* (Apollon77) Enhance checks and safeguards for polling intervals
* (Apollon77) Check for restart intervals that do not make sense and stop adapter if detected
* (Apollon77) Add additional crash-loop detection

### 3.18.6 (2022-07-19)
* (Apollon77) Fix deviceStop sequence command

### 3.18.5 (2022-07-19)
* (Apollon77) Fix crash case reported by Sentry
* (arteck) Add image for Fire Cube

### 3.18.3 (2022-07-18)
* (Apollon77) Fix doNotDisturb and doNotDisturb for All devices
* (Apollon77) Update do not disturb status after set for all devices
* (Apollon77) preserve a changed name for a "This device" device object

### 3.18.2 (2022-07-18)
* (Apollon77) Enable commands again for Apps with type A2TF17PFR55MTB - will only work sometimes as it seems

### 3.18.1 (2022-07-18)
* (Apollon77) Optimize Handling when push connection could not be established

### 3.18.0 (2022-07-18)
* IMPORTANT: Smart home device values are from now on only synchronized when enabled via #includeInIntervalQuery state. Enable only what's really needed!
* (Apollon77) Allow to query several more smart home device states (incl. the Echo own Temperature-Sensor if available) and more optimizations
* (Apollon77) Optimize querying smart home device states to only request relevant properties
* (Apollon77) Exclude some value types again from requesting from Amazon because they make no sense and will never contain meaningful data
* (Apollon77) Add FireTV commands for FireTV devices
* (Apollon77) Add CommandsAll.deviceStop and CommandsAll.deviceDoNotDisturb commands to be sent to all devices
* (Apollon77) Add Equalizer preferences (if supported by devices)
* (Apollon77) Add Speaker and AUX preferences (if supported by devices)
* (Apollon77) Add Display (enabled, brightness, adaptive brightness) preferences (if supported by devices)
* (Apollon77) Enhance doNotDisturb state to also allow specifying a enable duration or end timepoint
* (Apollon77) Add a fallback to update music player when a new history record mentions music as target for the spoken words. Could help as fallback when push infos are not coming in sometimes with Sonos
* (Apollon77) Delay initialization of push connection to when basic structures are initialized
* (Apollon77) Add some more devices

### 3.17.5 (2022-07-14)
* (Apollon77) Minimum smart home device query interval is now 5 minutes and not 1 minute anymore to remove some requests for now

### 3.17.4 (2022-07-13)
* (Apollon77) Make sure disabling query intervals really work (disabling smart home device and state and configuration was not possible)

### 3.17.3 (2022-07-12)
* (Apollon77) Prevent datatype warnings in log

### 3.17.2 (2022-07-12)
* (Apollon77) Another adjustment for smart home device data readings
* (Apollon77) Fix crash cases reported by Sentry

### 3.17.1 (2022-07-12)
* (Apollon77) Work around timing issues with speak-volume when using announcement
* (Apollon77) Correctly initialize volume/mute on startup also when player data are not available
* (Apollon77) Do not overwrite speak-volume (and some other fields) with null on adapter start
* (Apollon77) Fix crash cases reported by Sentry

### 3.17.0 (2022-07-11)
* (Apollon77) Add support to play Audible books in Music-Providers
* (Apollon77) Optimize deletion of alarms and reminders
* (Apollon77) Optimize requesting smart home device data

### 3.16.1 (2022-07-11)
* (Apollon77) Fix deletion and cancellation of Alarms and Reminders

### 3.16.0 (2022-07-11)
* (Apollon77) Add (official) support for Music-Alarms - they are now listed under "Alarms" together with the other Alarms! The "sound" list will contain the device specific music targets - so you can basically zse the ones that you created at least once via voice commands.
* (Apollon77) For a Music Alarm the "customVolume" on the alarm is used to set the normal device volume 2s before the alarm but do not (!) reset it afterwards
* (Apollon77) Prevent crashes on one time Alarms that just triggered

### 3.15.2 (2022-07-09)
* (Apollon77) Fix case where initialization of the adapter was never finished and so nothing was controllable when App devices where not synced

### 3.15.1 (2022-07-09)
* (Apollon77) Convert Smarthome device values if wrong datatype is delivered by device
* (Apollon77) Add handling for two more battery health states for smart home devices
* (Apollon77) Fix crash case when initializing notifications

### 3.15.0 (2022-07-09)
* (Apollon77) IMPORTANT: Format to specify multiple Details on "New" for Alarms and Reminders changed, see documentation!
* (Apollon77) Add Alarm/Reminder triggered state per device which will contain the ID of the alarm that got triggered when it is triggered
* (Apollon77) Add several more fields for Alarms and Reminders to show better the details of the alarm
* (Apollon77) Allow to cancel Reminders and Alarms as in the Alexa App
* (Apollon77) Allow to also edit Alarm/Reminder Dates additionally to the times
* (Apollon77) Allow to set a custom Volume for Reminders and Alarms - it will be set 2s before the expected trigger and restored afterwards
* (Apollon77) Calculate the "nextTriggerDate" as Timestamp of next expected triggering
* (Apollon77) Add a JSON-Array with all running timers and the "next id" as state
* (Apollon77) Allow to stop a timer by ID
* (Apollon77) Add the days-list of Alarms when configured for recurrency
* (Apollon77) Add new Commands skill and skillYours to start Skills
* (Apollon77) Add Notification volume, Ascending Alarm setting and default notification sounds as preferences
* (Apollon77) Slow down the initialization of all data a bit, so startup could take longer

### 3.14.0 (2022-07-06)
* (Apollon77) Allow to define if Lists and Smart home devices are synced by the adapter with the Amazon Cloud at all
* (Apollon77) Enhance Smart Home Device support by adding various controllers and states. If in your Alexa App something is configurable which is not in ioBroker please send a debug log!
* (Apollon77) Re-Introduce the ability to poll smart home device states in intervals, but only devices are queried that report their status proactively to Amazon-Cloud to prevent Skill developer costs! ioBroker (and OpenHab) devices are NOT queried! The interval can be configured but must not be lower than 60s! Querying is disabled by default.
* (Apollon77) Add message to send out sequences of commands to alexa devices
* (Apollon77) Add Info states for macAddress and WifiSSID of the Alexa devices
* (Apollon77) Add several new states for Player for allowed actions, medium quality
* (Apollon77) Add mediaId and also allow to set it to jump to a defined entry in the playlist
* (Apollon77) Add Commands.sound to play a sound
* (Apollon77) Do not set the speak-volume when executing textCommand and deviceStop
* (Apollon77) Do not set speak-volume if the volume is already as wanted when executing commands
* (Apollon77) update Do-Not-Disturb status once on start and with device configuration updates
* (Apollon77) Allow to specify the title in notification commands
* (Apollon77) When a device plays music in a group then new states in "Player"will indicate this together with the group ID
* (Apollon77) Allow to enable and disable smart home devices - this will be synced together with the smart home state updates from the cloud if changed in the app!
* (Apollon77) Detect Rate limit exceeded response and do one automatic request retry 10s later (plus a random part)
* (Apollon77) Slow down the update of player status to prevent rate limit exceeded errors. initial update of the player states is delayed on startup of the adapter
* (Apollon77) Restore character replacement for Music providers (space is now again a "-")
* (Apollon77) Add more devices
* (Apollon77) Optimize startup and unload handling

### 3.13.0 (2022-07-02)
* IMPORTANT List Names are now checked for invalid characters and replaced. Might change the name of objects in ioBroker. Old ones need to be deleted manually!
* (Apollon77) Fix command sending in multi owner environments (e.g. Family shared devices)
* (Apollon77) Add some new devices
* (ammawel) Add the date of an alarm as state, not only time
* (Apollon77) Add option to also query the App Devices to allow to send commands to them
* (Apollon77) Rework Multiroom for commands to prevent rate limiting issues!
* (Apollon77) Fix Routine Naming if triggers were used
* (Apollon77) Support devices with "Ziggy" as wake word
* (Apollon77) All commands with voice output respect the defined speak-volume now
* (Apollon77) Allow again to directly enter TuneIn station Ids (s*) and topicIds (t*)
* (Apollon77) Add media states to show remaining time of media playback
* (simatec) Adjust link color im Admin configuration
* (Apollon77) Some requests are automatically retried with a slight delay if Amazon responds with error 503

### 3.12.0 (2021-11-13)
* (Apollon77) SequenceNodes created for a device are now bound to the "deviceOwnCustomer" - should help in mixed owner groups
* (ammawel) Add recurringPattern for Notifications (see Readme)
* (Apollon77) Fix crash case
* (Apollon77) Make sure states are not set too early before objects are created

### 3.11.2 (2021-10-12)
* (Apollon77) Fix crash case (Sentry IOBROKER-ALEXA2-AT)

### 3.11.1 (2021-10-12)
* (Apollon77) Prevent warnings with js-controller 3.3

### 3.11.0 (2021-10-12)
* (Apollon77) Add support for Multi Utterance Routines
* (Apollon77) Fix object deletion for lists
* (Apollon77) Fix Creation of new Lists and add deletion support
* (Apollon77) Allow Commands for Stereo Pairs
* (Apollon77) Optimize Push Connection and History retrieval

### 3.10.4 (2021-10-11)
* IMPORTANT: Node.js 10 support is dropped, supports LTS versions of Node.js starting with 12.x
* (Apollon77) Update Push Connection

### 3.9.3 (2021-07-11)
* (Apollon77) Try to fix setting targetTemperature for ThermostatController

### 3.9.2 (2021-07-05)
* (Apollon77) Only ignore empty history entries if both, summary and alexaResponse is empty

### 3.9.1 (2021-06-04)
* (Apollon77) Fix cookie exchange and cookie validation checks

### 3.9.0 (2021-05-11)
* (Apollon77) Add some new devices
* (Apollon77) Always recognize "alexa" as wakeword to handle commands via the apps correctly

### 3.8.4 (2021-05-11)
* (Apollon77) Optimize Cookie refresh handling
* (Apollon77) Fix warnings from js-controller 3.3 and optimize

### 3.8.2 (2021-04-19)
* (Apollon77) Adjust automatic Cookie Refresh interval from 7 to 4 days

### 3.8.1 (2021-02-09)
* (Apollon77) Initialize volume for all devices on start

### 3.8.0 (2021-02-04)
* (Apollon77) Add configuration option to not write history entries where no command text was recognized

### 3.7.1 (2021-02-03)
* (Apollon77) add some more detected text into summary and answerText states (textCommand commands should be in history back again)

### 3.7.0 (2021-02-03)
* (Apollon77) IMPORTANT: History entries are now requested via a different data source because Amazon seems to tun off the old option. History.status is for this no longer filled, but new states were added. Only voice commands are reported ( textCommand entries not longer)
* (Apollon77) other optimizations in communications and prevent hammering amazon with requests in error cases

### 3.6.1 (2021-02-02)
* (fbeister) Add and adjust some known devices
* (Apollon77) Optimize object deletion

### 3.6.0 (2021-01-28)
* (Apollon77) Update Routines API because of amazon changes

### 3.5.6 (2021-01-22)
* (Apollon77) Catch error when deleting objects

### 3.5.4 (2021-01-22)
* (Apollon77) restart adapter when no initial cookie could be requested

### 3.5.2 (2021-01-17)
* (Apollon77) Prevent to write non-existing state values
* (Apollon77) Add and adjust some known devices

### 3.5.0 (2020-12-24)
* (Apollon77) Remove bespoken because textCommand is more flexible
* (Apollon77) Add and adjust some known devices, add Echo 4 image

### 3.4.0 (2020-12-11)
* (Apollon77) add support for textCommand - tell an Alexa device a text as you would speak it
* (Apollon77) make sure discovery of devices is still possible also after deleting all devices before

### 3.3.5 (2020-12-03)
* (Apollon77) make sure music providers with empty names do not produce errors

### 3.3.2 (2020-11-23)
* (Apollon77) prevent crash cases and optimize reconnection handling

### 3.3.1 (2020-07-24)
* (Apollon77) Further optimize Cookie handling

### 3.3.0 (2020-07-19)
* (Apollon77) Hopefully allow easier upgrades if old deviceId is invalid now
* (Apollon77) Allow to have separate deviceIds per instance

### 3.2.8 (2020-07-16)
* (Apollon77) Work around Amazon Security changes and make proxy working again

### 3.2.7 (2020-07-15)
* (Apollon77) Work around Amazon Security changes and make proxy working again
* (arteck) add echo studio

### 3.2.6 (2020-07-15)
* (Apollon77) Work around Amazon Security changes and make proxy working again

### 3.2.5 (2020-07-13)
* (Apollon77) Work around Amazon Security changes and make proxy working again 
* (Apollon77) fix Sentry crash case when Amazon do not respond correctly (IOBROKER-ALEXA2-1C)

### 3.2.4 (2020-06-18)
* (Apollon77) Update Alexa-Remote Library to optimize communication error/timeout cases

### 3.2.3 (2020-06-17)
* (Apollon77) Fix currentState handling

### 3.2.2 (2020-06-17)
* (Apollon77) remove goodnight because was not working
* (Apollon77) Fix Play/Pause states and some media optimizations

### 3.2.1 (2020-06-17)
* (Apollon77) update amazon-cookie library: another optimization for Node.js 14

### 3.2.0 (2020-06-17)
* (Apollon77/hive) add new commands, jokes/facts/goodnight/cleanup
* (Apollon77/hive) add new command curatedtts with allowed values ["goodbye", "confirmations", "goodmorning", "compliments", "birthday", "goodnight", "iamhome"] to play random curated sentences
* (Apollon77) Prevent some crashes
* (Apollon77) Make sure Timer are not triggering the state when deleted
* (Apollon77) make sure that Lists objects are deleted correctly when deleting
* (Apollon77) Make compatible with nodejs 14
* (Apollon77) Adjust to changes from Amazon so that initial Proxy process works again
* (OberstVonGatow) Make sure that for Spotify Media data requests do not have negative effects and stop the playback

### 3.1.2 (2020-03-18)
* (Gieskanne/Apollon77) Add Next Timer Date as state
* (Apollon77) Fix missing history entries
* (Apollon77) Prevent List deletions from logging errors
* (Apollon77) optimiztions, dependency updates and fixes
* (Apollon77) Switch to ioBroker own sentry instance
* (Apollon77) add Info.softwareVersion

### 3.0.8 (2020-01-19)
* (Apollon77) fix some crash cases
* (Apollon77) Update Sentry DSN and add filtering
* (Apollon77) Update deps

### 3.0.7 (2019-12-28)
* (Apollon77) Prevent some errors

### 3.0.6 (2019-12-26)
* (Apollon77) Prevent some errors

### 3.0.5 (2019-12-25)
* (Apollon77) Prevent some errors

### 3.0.4 (2019-12-24)
* (Apollon77) Prevent some errors

### 3.0.3 (2019-12-24)
* Adapter needs nodejs 8+ and js-controller 2.0 now!
* (Zefau) add functionality for handling of lists
* (Apollon77) Add answerText when available from history
* (Apollon77) handle error for empty valueMaps for ColorTemperatures
* (Apollon77) also support names for new special routines (Alarm Notifications, Sensor Detections, ..)
* (Apollon77) GitHub Actions for Test& Build
* (Apollon77) Add Sentry for error reporting
* (Apollon77) prevent some crashed after changes by Amazon
* (Apollon77) fix Routine names after changes by Amazon
* (Apollon77) add some devices and new images
* (Apollon77) Add more situations to update player status because amazon send no info anymore on title changes

### 2.6.4 (2019-07-25)
* (Apollon77) add some error handling for contacts

### 2.6.1 (2019-07-22)
* (Apollon77) add new device
* (Apollon77) fix volume logic for ssml
* (Apollon77) Allow reminders to bet set >+ 1day

### 2.6.0 (2019-07-21)
* (Apollon77) added possibility to send text messages to users including himself, allows deletion of all messages to himself
* (Apollon77) added option to reset Cookies. After sahev the adapter will restart and needs to get a new Login (see adapter config)
* (Apollon77) change announcement and ssml to send commands more synchronous

### 2.5.0/1 (2019-07-07/18)
* (INgoRah) Support compact mode
* (Apollon77) enhance error handling for broken authentications

### 2.4.6 (2019-07-05)
* (Apollon77) enhance error handling for broken authentications

### 2.4.5 (2019-07-01)
* (Apollon77) enhance error handling for broken authentications

### 2.4.4 (2019-06-26)
* (Apollon77) new devices added

### 2.4.3 (2019-06-25)
* (Apollon77) enhance error handling for Amazon Push Infos

### 2.4.1/2 (2019-06-23)
* (Apollon77) Allow to specify an external docker container IP to override Proxy-IP
* (Apollon77) Add more Devices from GitHub
* (Apollon77) try to work around an Image URL bug from Amazon
* (Apollon77) optimize Admin display of Status/Link
* (Apollon77) add Link to https://alexa.amazon.com to Admin instance overview
* (Apollon77) Remove Admin2 support
* (Apollon77) Optimize Handling from DNS errors (hopefully) to prevent stopped Adapters on Internet/DNS problems

### 2.3.3 (2019-06-21/22)
* (Apollon77) adjust to current Amazon changes
* (Apollon77) fix volume handling
* (Apollon77) Add some more devices
* (Apollon77) Logging reduced
* (Apollon77) unknown devices get commands activated automatically
* (Apollon77) remove Email/Password fields and add info about login to Admin screen (still needs to be polished, only Admin v3)
* (Apollon77) detect App-Devices and remove them from the list because they are not usable in any way

### 2.2.0 (2019-01-xx) [unpublished]
* (Apollon77) add new sequenceCommands "calendarNext", "calendarToday", "calendarTomorrow"
* (Apollon77) fix wake word handling and history sanitizing

### 2.1.0 (2019-01-13) [unpublished]
* (Apollon77) cookie handling completely rewritten, no email/password anymore, only Proxy (still only from log)
* (Apollon77) fixes routine triggering that triggered on wrong device sometimes
* (Apollon77) added new commands "deviceStop", "announcement", "notification", and "ssml" (see documentation above)

### 1.1.3 (2018-11-17)
* (Apollon77) optimize cookie handling again

### 1.1.2 (2018-11-17)
* (Apollon77) new devices
* (Apollon77) make proxy for cookies work again

### 1.1.1 (2018-11-09)
* (Apollon77) new devices
* (Apollon77) make proxy for cookies work again

### 1.1.0 (2018-09-18)
* (Apollon77) Further optimizations to lower number of requests
* (Apollon77) Experimental support for Playlist IDs (p1234567) in TuneIn-Station

### 1.0.1 (2018-09-16)
* (Apollon77) fixes and important changes to make sure not too many requests are sent

### 1.0.0 (2018-09-06)
* (Apollon77) polishng and finalization, make it 1.0.0

### 0.7.5 (2018-09-04)
* (Apollon77) speak can now contain separated text by semicolons. These Texts will then be spoken sequencially. So the old limit if 250 characters is only existing for one such text part. So, now longer texts are possible too. Separate it with a semicolon.
* (Apollon77) more color handling fixes

### 0.7.0 (2018-08-30)
* (Apollon77) Add Bespoken Virtual device support to be able to interact with Alexa infrastructure
* (Apollon77) add new Device Types for Smarthome-integration (Contact and Motion sensors)

### 0.6.4 (2018-08-30)
* (Apollon77) fixes to colorhandling
* (Apollon77) allow to deliver a volume together with aspeak command by using "80;text" and then volume is set before speak and reset afterwards. Experimental!

### 0.6.1 (2018-08-24)
* (Apollon77) sometimes new alarms were not triggered in adapter
* (Apollon77) add support to control smart devices and groups (and also add groups). Because I was only able to test a few types i added logging. please check log, try out and report back!
* (Apollon77) When routines are executed via voice command and push connection is enabled the routine state is also triggered by "true" with ack=true when routine trigger text is matching exactly to spoken text
* (Apollon77) corrected volume and mute handling in states, a volume of 0 is also seen as "muted" if muting flag is not supported by device
* (Apollon77) when speak text is coming from cloud adapter and contains SSML tags they will be filtered out, so you can use a speak endpoint directly to output response from Smart Home skill actions

### 0.5.2 (2018-08-16)
* (Apollon77) fix an error when getting new cookie
* (Apollon77) add new "Playlist" states for the Music providers to directly prepend "playlist" :-)
* (Apollon77) Volumes are not updated for multiroom devices when === 0
* (Apollon77) Add Reminder and Alarms support. Write time and pot. text separated by comma into the "New" stat to create a new one (e.g. "10:00:00, Test-Reminder")
* (Apollon77) Also with Push-Connection some times states are generally updated to make sure data are correct (e.g. player media info will disappear 2h after stopping the music)
* (Apollon77) Added some more deviceTypes

### 0.4.0 (2018-08-13)
* (Apollon77) internal Refactoring
* (Apollon77) states that are not needed anymore will be removed. This will be logged for now, so please check this and give feedback!
* (Apollon77) sanitized music provider state names (spaces are now dashes ... should be removed automatically)
* (Apollon77) Renamed TuneIn-Direct to TuneIn-Station (even if you still can enter text to search, this works with stations too) ... should be removed automatically)
* (Apollon77) Device and Bluetooth status is now also checked at states update
* (Apollon77) After enabling Push-Connection the configured polling is turned off and anything is done based on real time informations from Alexa. Test it
* (Apollon77) Enhanced History states to include the status of the action (SUCCESS, FAIL ...), infos from returned cards (if available) and info on accessed skill for this action.
* (Apollon77) When using Push-Connection History update is also updated automatically. An empty summary with status DISCARDED_NON_DEVICE_DIRECTED_INTENT means the activation of the echo by saying the wake word
* (Bluefox) Add icons for some of the devices for Admin

### 0.3.8 (2018-07-27)
* (Apollon77) Several Multiroom-fixes
* (Apollon77) fixed shuffle/repeat
* (Apollon77) fixed status for play, pause, shuffle and repeat

### 0.3.4 (2018-07-27)
* (Apollon77) Only 20 Routines were queried, now up to 2000
* (Apollon77) Also allow commands including speak for multiroom, BUT it is triggered per device, so NO synchronous audio output!!
* (Apollon77) Thanks to Matten-Matten also Music-provers can be started on multiroom devices

### 0.3.2 (2018-07-25)
* (Apollon77) Fix volume settings for multiroom devices (please report other devices where it is not working)
* (Apollon77) Add serial number and name to Info

### 0.3.0 (2018-07-24)
* (Bluefox) Admin3 fixes and slight changes to roles and code
* (Apollon77) Reworked state names (hopefully last time!)
* (Apollon77) Combine Player-Control and Player-Info into channel Player to support better detection and material support
* (Apollon77) Added further information in Infos states per echo device
* (Apollon77) Try to detect the type of the device different and decide if commands are available or not (till capabilities are known better)
* (Apollon77) New "Music-Provider" states depending on available music providers with possibility to enter a text to play something (same as you would speak it)
* (Apollon77) Volume is send different now, so that it also works when Device player get's inactive

### 0.2.4 (2018-07-22)
* (pix) materialize settings window
* (Apollon77) WOn IP is set automatically with IP from first network interface
* (Apollon77) fix comma replacements in speaks, do not speak empty text
* (Apollon77) if Device is Multiroom, the do not create Routines and Commands and not bluetooth
* (Apollon77) add information about multiroom device and master (later we can use this to sort out commands that are impossible with multiroom)
* (Apollon77) History is also stored as JSON, so it can be used to monitor one datapoint and have all infos on updateState
* (Apollon77) Several other fixes

### 0.2.3 (2018-07-20)
* (Apollon77) in Numbers with . are replaced by commas

### 0.2.2 (2018-07-20)
* (Apollon77) Finally fix device renaming

### 0.2.1 (2018-07-20)
* (Apollon77) Small fix of history channel type and setting states initially

### 0.2.0 (2018-07-20) (as iobroker.alexa2)
* (Apollon77) 0.2.0: added many Player-Info datapoints including "progress updates " when media is playing
* (Apollon77) 0.2.0: removed "Notifications" because the only benefit for now is to show them, no interaction or change possible
* (Apollon77) 0.2.0: adapter now allows to configure intervals for history updates and other data updates like player info
* (Apollon77) 0.2.0: if cookie could not be determined correctly a proxy is started to allow manual login and cookie is catched in the background on success
* (Apollon77) 0.2.0: add info datapoints for connection (connected to Alexa), cookie and csrf
* (Apollon77) 0.2.0: rework complete logic to not use soef library anymore
* (Apollon77) 0.2.0: Speaking free text at any timepoint is available under Commands.speak
* (Apollon77) 0.2.0: Sequence-Commands (weather, traffic, flashbriefing, goodmorning, singasong, tellstory) are available to be triggered under "Commands"
* (Apollon77) 0.2.0: Automation-Routines are now available to be triggered per device under "Routines"
* (Apollon77) 0.2.0: Automatically use different user-agents for Win32, MacOS and Linux based systems
* (Apollon77) 0.2.0: Automatically use different user-agents for Win32, MacOS and Linux based systems
* (Apollon77) 0.2.0: Also support entering TuneIn-Station IDs ("s" plus 4-6 digits) to play that station

### 0.1.0 (2018-07-10)
* (Apollon77) get Adapter working again, especially getting cookie and optimize refresh

### 0.0.x
* soef versions

## License

The MIT License (MIT)

Copyright (c) 2018-2025 Ingo Fischer <iobroker@fischer-ka.de>, 2017-2018 soef <soef@gmx.net>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.