---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translatedFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/adapterref/iobroker.cec2/README.md
title: ioBroker.cec2
hash: fP67Ti8lt/GHkCAQmbZG+yTnrqh6Wlmt0a9BynPEatQ=
---
![Логотип](../../../en/adapterref/iobroker.cec2/admin/cec2.png)

![НПМ-версия](https://img.shields.io/npm/v/iobroker.cec2.svg)
![Загрузки](https://img.shields.io/npm/dm/iobroker.cec2.svg)
![Количество установок](https://iobroker.live/badges/cec2-installed.svg)
![Текущая версия в стабильном репозитории.](https://iobroker.live/badges/cec2-stable.svg)
![НПМ](https://nodei.co/npm/iobroker.cec2.png?downloads=true)

# IoBroker.cec2
**Тесты:** ![Тестирование и выпуск](https://github.com/iobroker-community-adapters/ioBroker.cec2/workflows/Test%20and%20Release/badge.svg)

Адаптер для HDMI CEC

Вы можете контролировать/управлять устройствами с помощью HDMI CEC. Большинство современных телевизоров и мультимедийных устройств в той или иной степени поддерживают CEC.

## Информация
При запуске этот адаптер запускает cec-клиент и опрашивает все устройства на шине HDMI. Для каждого устройства CEC создается устройство в ioBroker. OSDName устройства станет его идентификатором в ioBroker (поскольку оно не должно меняться и хорошо читаемо).
Если устройства появятся во время выполнения, они также будут добавлены в ioBroker.

#### Адреса ЦИК
Краткое введение об адресах ЦИК, вы можете пропустить это, но, возможно, захотите прочитать здесь, если вас запутает описание ниже.

В ЦИК есть два типа адресов. Оба важны.

##### Логический адрес
Логический адрес представляет собой число от 0 до 15 (или F в шестнадцатеричном формате, который обычно используется). Число определяет, что это за устройство:

* 0 = ТВ
* 5 = Аудиосистема
* 4,8,11 = Воспроизведение
* 1,2,9 = Запись
* 3,6,7,10 = Тюнер

Остальные зарезервированы (12,13), бесплатно (14) и незарегистрированы/транслируются (15). Устройства, использующие эти адреса, ограничены в общении.

Логический адрес назначается динамически. Это означает, что в один день может возникнуть ситуация, что Playback A будет назначен адрес 4, а Playback B — 8. Но на следующий день они будут включены в другом порядке, и тогда A получит 8, а B 4. (Некоторые устройства всегда активны. на шине ЦИК хоть и поэтому цепляются за свои адреса). Если устройств одного типа слишком много (т.е. 4 устройства воспроизведения), то логические адреса придется использовать повторно, и это произойдет. Адаптер пытается справиться с этим случаем.

Логический адрес используется для адресации сообщений и отчетов.
ioBroker также нуждается в логическом адресе, чтобы получать отчеты из шины. Поэтому настройте адаптер на тип устройства, о котором вы знаете, что у вас есть свободные логические адреса (например, запись).

##### Физический адрес
Физический адрес основан на портах HDMI, задействованных в устройстве. По сути, это путь номеров портов к устройству. Он состоит из 4 цифр, разделенных точками. Некоторые примеры:

* 0.0.0.0 = ТВ
* 1.0.0.0 = 1. Порт HDMI телевизора
* 2.0.0.0 = 2. Порт HDMI телевизора
* 2.2.0.0 = 2. Порт HDMI телевизора, 2. Порт HDMI свитча/AV-ресивера
* 4.1.2.0 = 4. Порт HDMI телевизора, 1. Порт HDMI AV-ресивера/коммутатора, 2. Порт HDMI следующего AV-ресивера/коммутатора

Это должно дать основную идею. 0 означает, что путь заканчивается.

Физический адрес является фиксированным для устройства, если только оно не подключено к другому порту HDMI (или к любому устройству, прежде чем оно будет видно по телевизору).

#### Состояний на устройство
Для каждого устройства созданы следующие состояния:

* info.active = устройство недавно было обнаружено, и логический адрес должен быть правильным.
* info.cecVersion = должно быть 1.4, определяет функции
* info.lastSeen = последнее сообщение от устройства на шине CEC
* info.ologicalAddress = логический адрес в виде числа
* info.ologicalAddressHex = логический адрес в виде шестнадцатеричного числа (необходим для собственных команд)
* info.Name = имя, которое устройство устанавливает в шине CEC.
* info.physicalAddress = физический адрес
* info.Vendor = поставщик устройства
* activeSource = является ли устройство активным источником? Можно переключить это устройство в качестве активного источника
* MenuStatus = позволяет управлять устройством с помощью пульта телевизора
* состояние = состояние питания устройства (позволяет включать/выключать его, если поддерживается)
* createButtons = нажмите здесь, чтобы сгенерировать состояния кнопок в подпапке .buttons.
* button.time = время нажатия кнопки (по умолчанию 500 мс).

## Кнопки
Нажатия кнопок работают не для всех устройств, и некоторым может потребоваться активное соединение с устройством ioBroker для управления через шину CEC.
Для FireTV все работает вполне нормально.
Чтобы проверить нажатие кнопок, нажмите кнопку `createButtons` на устройстве и протестируйте некоторые из созданных кнопок в некоторых ситуациях. Питание работает на довольно многих устройствах.

#### Глобальные состояния
Существуют следующие глобальные состояния:

* active-source = физический адрес текущего активного источника (может быть установлен для переключения входов)
* arc = Канал возврата аудио (не)активен, его можно (де)активировать здесь
* mute = отключить звук Аудиосистема
* raw-command = отправлять команды напрямую cec-клиенту (например, «scan» или tx + CEC Command с http://www.cec-o-matic.com/)
* standbyAll = перевести все устройства в режим ожидания
* systemAudio = Аудиосистема используется/не используется. Информирует устройства о том, что они должны отправлять команды громкости/отключения звука в аудиосистему.
* громкость = громкость аудиосистемы, 0 = отключение звука
* VolumeUp/Down = изменить громкость аудиосистемы

#### Состояния опроса
Для большинства состояний имеется подпапка «опрос» с состояниями кнопок. Если кнопка нажата, адаптер выдаст команду на шину CEC для опроса значения и соответствующей установки состояния (однако, к сожалению, не все устройства реагируют на сообщения опроса).

#### Требования
Должен быть установлен cec-клиент. Обычно можно установить с помощью:

```
sudo apt install cec-utils
```

Пользователю, запускающему iobroker (ныне «iobroker»), необходим доступ к /dev/vchiq. Для этого вам может потребоваться добавить пользователя iobroker в группу видео:

```
sudo usermod -a -G video iobroker
```

#### Монтаж
Выполните следующую команду в корневом каталоге iobroker (например, в /opt/iobroker)

```
npm install iobroker.cec2
```

Или установите с веб-страницы администратора.

## Конфигурация
* Имя OSD: это имя будет сообщено другим устройствам, например вашему телевизору. Возможно, вам придется выбрать там ioBroker, чтобы получить удаленное управление в ioBroker.
* Тип устройства: вы можете установить тип устройства. См. обсуждение логического адреса выше, чтобы понять, что это значит. Используйте тип устройства, которого у вас не так много.
* запретить безымянные устройства: иногда устройства не сообщают свое имя в определенных ситуациях (например, Nintendo Switch не сообщает свое имя в режиме ожидания, а объявляет себя). В таких ситуациях адаптер может создать дубликат устройства по его физическому адресу (т.е. по номерам). Вы можете включить эту опцию, чтобы предотвратить это.

## Примеры скриптов:
См. [примеры скриптов](doc/ExampleScripts.md) для некоторых примеров сценариев, которые помогают с/восстановление настроек мультимедиа.

## Changelog

<!--
    Placeholder for the next version (at the beginning of the line):
    ### **WORK IN PROGRESS**
-->
### 0.1.1 (2023-09-06)
* dependency updates.
* sending commands is now more reliable.
* more error handling

### 0.1.0 (2021-02-18)
* add more translations.
* add more options (poll TV power).

### 0.0.8 (2021-02-14)
* Switched from unmaintained dependency to own code to control cec-monitor binary.
* Swtiched from event-stream to readline.
* Probably fixed missed incomming events.

### 0.0.7 (2021-01-24)
* fix warnings

### 0.0.6 (2021-01-02)
* update dependencies

## License
MIT License

Copyright (c) 2020-2023 Garfonso <garfonso@mobo.info>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
