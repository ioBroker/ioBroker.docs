---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translationFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/adapterref/iobroker.parser/README.md
title: без заголовка
hash: Lekbr2Mm+it1a41tJJrl3ZTrIUyZInVXWP30U4Rlyh8=
---
![логотип](../../../en/adapterref/iobroker.parser/admin/parser.png) адаптер ioBroker для анализатора

![Количество установок](http://iobroker.live/badges/parser-stable.svg)
![Версия NPM](http://img.shields.io/npm/v/iobroker.parser.svg)
![Загрузки](https://img.shields.io/npm/dm/iobroker.parser.svg)
![тесты](https://travis-ci.org/ioBroker/ioBroker.parser.svg?branch=master)
![NPM](https://nodei.co/npm/iobroker.parser.png?downloads=true)

=================

Этот адаптер анализирует данные, полученные через URL или из файла, используя регулярные выражения. Для каждого правила, настроенного в настройках этого адаптера, будет создано состояние в соответствии с `parser.<instance number>`, которое будет заполнено и дополнено проанализированной информацией.

## Настройки
### 1. Интервал опроса по умолчанию
Это значение интервала опроса по умолчанию будет использоваться, если не указано отдельное значение интервала опроса для записи в таблице конфигурации (столбец: «Интервал»). Интервал указывается в миллисекундах и определяет частоту чтения ссылки или файла и обновления состояний.

** Примечание: ** Не используйте слишком агрессивный интервал опроса, особенно для URL-адресов веб-сайтов. Например, если вы хотите получить цену своих акций с определенного веб-сайта, вам, вероятно, следует использовать интервал, равный каждые 24 часа (= 86400000 мс), если вы не являетесь дневным трейдером. Если вы попытаетесь получить данные с определенных URL-адресов слишком часто, веб-сайт может забанить вас и внести в черный список сервера. Поэтому, пожалуйста, используйте интервал опроса с осторожностью.

### 2. Таблица
Нажмите кнопку «Плюс», чтобы добавить новую запись в таблицу.

** Примечание по производительности: ** Если вы вводите один и тот же URL или имя файла более одного раза в разные строки таблицы, и если значения столбца «Интервал» одинаковы, содержимое URL или имени файла будет получено только ** один раз ** и кэшируется для обработки нескольких строк таблицы, соответствующих URL / имени файла и интервалу. Это позволяет применять несколько регулярных выражений (например, несколько строк таблицы) к одному URL-адресу или имени файла без необходимости многократного извлечения данных из источника.

** Поля таблицы: **

- ***Name*** - имя состояния, которое создается в `parser. <Номер экземпляра>`. Пробелы не допускаются. Вы можете использовать точки "." в качестве разделителя для создания подпапок. Пример: `Shares.Microsoft.Current` приведет к` parser. <Номер экземпляра> .Shares.Micosoft.Current`.
- ***URL-адрес или имя файла*** - либо URL-адрес веб-сайта, либо путь к файлу, из которого мы хотим получить информацию. Примеры: https:// darksky.net / forecast / 48.1371,11.5754 / si24 / de` (информация о погоде Мюнхен) или `/ opt / iobroker / test / testdata.txt` (файл из ioBroker).
- ***RegEx*** - регулярное выражение, как извлечь данные из ссылки. Существует хороший сервис для проверки выражений регулярных выражений: [regex101] (https://regex101.com/). Например. * temp swip "> (-? \ d +) ˚ <* для строки выше.
- ***Item*** (немецкий: "Num") - регулярное выражение может найти (сопоставить) несколько записей. С помощью этой опции вы можете определить, какое совпадение выбрать. 0 = первое совпадение, 1 = второе совпадение, 2 = третье совпадение и т. Д. По умолчанию 0 (первое совпадение).
- ***Роль*** - одна из ролей:
    - custom - пользователь определяет себя через * admin "роль
    - температура - значение есть температура
    - значение - значение представляет собой число (например, диммер)
    - жалюзи - значение является слепой позицией
    - switch - значение - это положение переключателя (true / false)
    - кнопка - значение кнопки
    - индикатор - логический индикатор
- ***Тип*** - тип переменной в раскрывающемся меню.
- ***Единица*** - Необязательно: единица добавленной стоимости к записи о состоянии. Например. `°C`,` € `,` GB` и т. Д.
- ***Старый*** - Если этот параметр активирован, состояние *не* будет обновляться, если значение не может быть прочитано или найдено в предоставленную дату (URL или файл), поэтому в этом случае оно сохранит прежнее значение.
- ***Subs*** - Необязательно: подставьте URL или имя файла. Этот замещающий URL / имя файла будет использоваться, если URL / имя файла первого столбца недоступны.
- ***Коэффициент / Смещение*** (только для чисел типа) - позволяет изменить извлеченные данные перед установкой в состояние:

* вычисленное значение * = * извлеченное значение * * коэффициент + смещение, чтобы немедленно изменить значение

- ***Интервал*** - интервал опроса в мс (миллисекундах). Если пусто или 0, будет использоваться интервал опроса по умолчанию. Пожалуйста, смотрите дополнительную информацию выше.

## Пример настроек
| Имя | URL или имя файла | RegEx | Роль | Тип | Блок | Интервал |
|-------------------|:-----------------------------------------------------|:----------------------|--------------|---------|------|----------|
| температура Мюнхен | `https://darksky.net/forecast/48.1371,11.5754/si24/de` | `temp swip">(-?\d+)˚<` | температура | номер | °C | 180000 |
| cloudRunning | `https://iobroker.net/` | `Privacy Notice` | индикатор | логическое значение | | 60000 |
| температура процессора | `/sys/devices/virtual/thermal/thermal_zone0/temp` | `(.*)` | температура | номер | °C | 30000 |
| stockPrice.Visa | `https://www.finanzen.net/aktien/visa-aktie` | `\d{0,3},\d{2}(?=<span>EUR<\/span>)` | значение | номер | € | 86400000 |
| stockPrice.Visa | `https:// www.finanzen.net / aktien / visa-aktie` | `\ d {0,3}, \ d {2} (? = <span>EUR &lt;\ / span&gt;)` | значение | номер | € | 86400000 |</span> |

* Примечание: * При применении регулярных выражений к полученным данным URL / файла все разрывы строк будут заменены пробелами, чтобы разрешить многострочный поиск.

## О регулярных выражениях (RegExp)
Регулярные выражения - это мощный инструмент для анализа и извлечения определенных данных из строк, и, что еще важнее, он позволяет извлекать определенные значения / текст из заданной строки (например, из HTML веб-страницы или текста из файла), применяя правила ,

Для логических типов регулярное выражение довольно просто. Для числовых типов вы должны отметить число в скобках - "()". Например. чтобы извлечь число из *Температура 5 °C* Вы должны использовать выражение "(\ d +)".

Дополнительная информация о RegExp:

  * [Документация MDN / Mozilla] (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp)
  * [regex101: онлайн-инструмент для создания и тестирования регулярных выражений] (https://regex101.com/)

### Примеры
- *.at* соответствует любой трехсимвольной строке, оканчивающейся на «at», включая «hat», «cat» и «bat».
- *[hc] at* соответствует "hat" и "cat".
- *[^ b] at* соответствует всем строкам, совпадающим с .at, кроме "bat".
- *[^ hc] at* соответствует всем строкам, сопоставленным .at, кроме "hat" и "cat".
- *^ [hc] at* соответствует «hat» и «cat», но только в начале строки или строки.
- *[hc] в $* соответствует "hat" и "cat", но только в конце строки или строки.
- *\ [. \]* соответствует любому отдельному символу, заключенному в «[» и «]», так как скобки экранированы, например: «[a]» и «[b]».
- * s. \ ** соответствует s, за которым следуют ноль или более символов, например: «s» и «saw» и «seed».
- *[hc] + at* соответствует «hat», «cat», «hhat», «chat», «hcat», «cchchat» и т. д., но не «at».
- *[hc]? at* соответствует "hat", "cat" и "at".
- * [hc] \ * at * соответствует "hat", "cat", "hhat", "chat", "hcat", "cchchat", "at" и так далее.
- *cat | dog* соответствует "cat" или "dog".
- *(\ d +)* - получить число из строки
- *сейчас (\ w +)* позже - получить слово между "сейчас" и "позже"

### Другие полезные выражения
- (-? \ d +) получить номер (как отрицательные, так и положительные числа)

## Коды качества
Значения могут иметь коды качества:

- 0 - ОК
- 0x82 - URL или файл не могут быть прочитаны.
- 0x44 - число или строковое значение не найдено в тексте

## Служба поддержки
1. Общие сведения: [Форум ioBroker] (https://forum.iobroker.net/). Немецкоязычные пользователи: см. [Ветку форума ioBroker Parser-Adapter] (https://forum.iobroker.net/topic/4494/adapter-parser-regex).
2. В случае каких-либо проблем, пожалуйста, проверьте [ioBroker Parser Adapter: Github Issues] (https://github.com/ioBroker/ioBroker.parser/issues).

## Changelog
### 1.0.7 (2018-10-08)
* (bluefox) Comma will be replaced automatically by point for the offset and for the factor

### 1.0.6 (2018-09-22)
* (bluefox) fix parser

### 1.0.5 (2018-08-30)
* (bluefox) Multi-line search allowed

### 1.0.2 (2018-08-06)
* (bluefox) Iterations in regex were corrected

### 1.0.1 (2017-12-10)
* (bluefox) Added additional option: old value

### 1.0.0 (2017-05-19)
* (bluefox) Allow set the number of found item

### 0.2.2 (2017-04-03)
* (Apollon77) fix handling of multiple fields for one URL

### 0.2.1 (2017-02-24)
* (bluefox) fix error with timestamp

### 0.2.0 (2017-02-01)
* (bluefox) Add visual test

### 0.1.1 (2017-01-30)
* (bluefox) move to common group

### 0.0.1 (2017-01-16)
* (bluefox) initial commit