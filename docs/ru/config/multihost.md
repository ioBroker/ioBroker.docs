---
title: multihost
lastChanged: 13.09.2018
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/config/multihost.md
translatedFrom: de
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translationFrom», в противном случае этот документ будет снова автоматически переведен
hash: bn0CAoBAN5DPBn11696x47c991NbZ42OEAQayrrozEY=
---
# Операция с несколькими хостами
ioBroker может выполнять задачи несколькими серверами. Это позволяет распределить вычислительную нагрузку между несколькими хостами.
Но вы также можете использовать системные расширения одноплатного компьютера (GPIO от RaspberryPi, хотя «главный компьютер» является более мощным Intel NUC).

После создания системы с несколькими хостами все настройки выполняются централизованно через администратора мастера. Администратор подчиненного (их) больше не может быть достигнут через их веб-интерфейс (ы).

Поэтому для ведомого устройства имеет смысл использовать хост с минимальной установкой, то есть только контроллер js и администратор.

## Установка
### Мастер конфигурации
Выполните следующую команду на мастере:

** Этот шаг абсолютно необходим, если используется Redis DB. ** В других случаях вы можете использовать его, если автоматический метод (см. Ниже) не работает. Затем, пожалуйста, выберите f (ile) вместо r (edis)!

пожалуйста, позвоните через консоль:

1. `iobroker setup custom`

Заполните меню, которое теперь выглядит следующим образом

```
Type of objects DB [(f)ile, (c)ouch, (r)edis], default [file]: f
Host / Unix Socket of objects DB(file), default[0.0.0.0]:
Port of objects DB(file), default[9001]:
Type of states DB [(f)file, (r)edis], default [file]: r
Host / Unix Socket of states DB (redis), default[127.0.0.1]: 0.0.0.0
Port of states DB (redis), default[6379]:
Data directory (file), default[../../../iobroker-data/]: /opt/iobroker/iobroker-data/
Host name of this machine [ioBroker-RasPi]:
```

2. `iobroker multihost enable`

``` enter pass phrase```

3. `sudo service iobroker restart`

### Ведомая конфигурация
** Этот шаг абсолютно необходим, если используется Redis DB. **

Пожалуйста, войдите через консоль на раб

1. `sudo iobroker setup custom`

Заполните меню, которое теперь выглядит следующим образом

```
Type of objects DB [(f)ile, (c)ouch, (r)edis], default [file]: f
Host / Unix Socket of objects DB(file), default[127.0.0.1]: <MASTER-IP>
Port of objects DB(file), default[9001]:
Type of states DB [(f)file, (r)edis], default [file]: r
Host / Unix Socket of states DB (redis), default[<MASTER-IP>]:
Port of states DB (redis), default[6379]:
Host name of this machine [raspi-sub-1]:
```

в конце появляется информация:

```
creating conf/iobroker.json
```

2. `iobroker multihost connect`

и заполните следующие диалоговые окна соответственно:

```
1 |       <MASTER-IP> |  host |       192.168.86.42 | "authentication required"
Please select host [1]: 1
Enter secret phrase for connection: *****

Config ok. Please restart ioBroker: "iobroker restart"
```

2. `sudo service iobroker restart`

Вновь созданный хост появится в основной системе в разделе Хосты.

Если этого не произошло, перезагрузите оба хоста. сначала хозяин, потом раб.

## Мультихост с разными подсетями
** Если оба хоста ioBroker находятся в разных подсетях, ...

Пример: **

* Обычная локальная сеть (для ПК, планшета, используйте.) = 192.168.178.0/24
* IoT LAN (для Шелли, камер и т. Д.) = 10.20.30.0/24

... автоматический мультихост («sudo iobroker multihost enable» и «sudo iobroker multihost browse») не работает, а только старый способ (`iobroker setup custom`), см. выше

## Мультихост с редисом
Если необходимо установить среду с несколькими хостами, в которой состояния сохраняются в redis, есть еще несколько вещей, которые следует учитывать.

Файл redis.conf на хосте, на котором должны быть сохранены состояния, должен быть изменен следующим образом.

```
nano /etc/redis/redis.conf
```

Содержащаяся в нем строка `bind 127.0.0.1` должна быть дополнена IP-адресом сетевого адаптера, чтобы сервер Redis разрешал подключение извне.

Так например

```
bind 127.0.0.1 192.168.1.10
```

предполагая, что 192.168.1.10 является локальным IP-адресом мастера ioBroker.

Эта настройка необходима только для мастера.

Кроме того, вы можете

```
bind 0.0.0.0
```

Наконец перезапустите сервер или компьютер Redis. например:

```
sudo service redis-server restart
```

Распределить задачи
Есть два способа распределить задачи по хостам.

* Если это новая установка, выберите хост, на котором должен быть установлен экземпляр адаптера, из выпадающего меню над списком адаптеров на вкладке Адаптер.

Затем добавьте туда экземпляр, нажав на (+) в правом столбце.

* Если вы уже установили много адаптеров на хосте, вы можете изменить назначение установленных экземпляров на вкладке Экземпляры.

## Удалить хост
Чтобы удалить хост, активируйте экспертный режим на вкладке объектов мастера и активируйте хост выбора в столбце Тип. Затем удалите нужный хост.

## Возможные проблемы
иногда появляется сообщение, похожее на:

```> ... bytes ... in strict mode```

Затем, пожалуйста, отредактируйте файл, в котором происходит появление, с помощью редактора nano. В самом начале есть `'use strict';`, прокомментируйте эту строку с помощью // и сохраните.

```> IP Address of the host is 127.0.0.1. It accepts no connections. Please change.```

если вы не сделали ``` setup custom ``` в основной системе