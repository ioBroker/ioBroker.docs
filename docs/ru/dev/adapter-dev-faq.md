---
translatedFrom: en
translatedWarning: Если вы хотите отредактировать этот документ, удалите поле «translationFrom», в противном случае этот документ будет снова автоматически переведен
editLink: https://github.com/ioBroker/ioBroker.docs/edit/master/docs/ru/dev/adapter-dev-faq.md
title: Часто задаваемые вопросы по разработке адаптеров
hash: xBifYSMkiSeEcOHVKuK3c1SR01Qr030mxrhtOv9htBA=
---
# Часто задаваемые вопросы по разработке адаптеров
## Введение
Идея этой страницы — собрать часто задаваемые вопросы по разработке адаптеров ioBroker.
Эта идея родилась у Ральфа на канале Discord ioBroker #adapter 24 ноября 2020 года во время обсуждения с вопросом от Мика.

## Пожалуйста, внесите свой вклад (это очень просто!)
Не стесняйтесь добавлять любые вопросы и соответствующие ответы на эту страницу. Единственное ограничение: обязательно укажите дату ответа. Не нужно быть перфекционистом, просто напишите, что помогло вам в разработке адаптера. Ссылки на адаптеры, в которых реализован вопрос, также приветствуются. Мы, разработчики, любим видеть примеры реализации :-)

*Примечание:* Это не будет официальной документацией. Любые подсказки, обходные пути, ссылки на более старые сообщения на форуме и т. д. приветствуются. Цель — быстро поддержать и помочь разработчикам в часто задаваемых вопросах. Если у вас возникли проблемы с написанием здесь на английском языке, используйте свой местный язык, например, немецкий, русский и т. д., мы будем рады помочь и перевести позже.

Для обновления оглавления можно использовать генератор TOC, например [luciopaiva.com/markdown-toc](https://luciopaiva.com/markdown-toc/)

# Оглавление
- [Обновления адаптера](#adapter-updates)
- [Обновления адаптера публикации](#publishing-adapter-updates)
- [Тестирование адаптера и отчеты об ошибках](#adapter-testing-and-error-reporting)
- [Компактный режим](#compact-mode)
- [Часовой](#часовой)
- [Интерфейс конфигурации адаптера (admin/index_m.html)](#adapter-configuration-ui-adminindexmhtml)
- [Проверка входных данных](#input-validation)
- [Функции адаптера](#adapter-functions)
- [Запись файлов](#writing-files)

---

### Обновления адаптера
#### Обновления адаптера публикации
**Вопрос:** В каких файлах мне нужно изменить номер версии?

**Ответ:** По сути, вам нужно коснуться 3 файлов:

* `io-package.json`: изменить номер версии и добавить журнал последних изменений
* `package.json`: изменить только номер версии
* `README.md`: добавить новый номер версии и журнал изменений

Обратите внимание, что необходимо использовать [Семантическое версионирование](https://semver.org/), см. [Версионирование](https://github.com/ioBroker/ioBroker.docs/blob/master/docs/en/dev/adapterdev.md#versioning).<br> (25-ноя-2020)

**Вопрос:** Мой адаптер находится в последнем репозитории. Я обновил адаптер на Github и опубликовал его также на NPM. Когда пользователи увидят новую версию в Admin?

**Ответ:** ioBroker сканирует на предмет изменений версий дважды в день.<br> (25-ноя-2020)

**Вопрос:** Как добавить новый адаптер в последний репозиторий?

**Ответ:** См. [Добавить новый адаптер в последний репозиторий](https://github.com/ioBroker/ioBroker.repositories#add-a-new-adapter-to-the-latest-repository)<br> (25-ноя-2020)

### Тестирование адаптера и отчеты об ошибках
#### Компактный режим
**Вопрос:** Как протестировать компактный режим?

**Ответ:** См. [Тест компактного режима](https://forum.iobroker.net/topic/32789/anleitung-f%C3%BCr-adapter-entwickler-compact-mode-testen) (на немецком языке)<br> (25-ноя-2020)

#### Часовой
**Вопрос:** Как добавить Sentry к моему адаптеру?

**Ответ:** См. [Sentry Read.me](https://github.com/ioBroker/plugin-sentry#readme)<br> (25-ноя-2020)

### Пользовательский интерфейс конфигурации адаптера (admin/index_m.html)
#### Проверка входных данных
**Вопрос:** Я хотел бы проверить поля конфигурации адаптера, используя основные методы адаптера, а также классы/методы кода адаптера node.js. Проверка должна происходить, как только пользователь нажимает «сохранить» в конфигурации адаптера, что затем вызовет `save()` из `admin/index_m.html`.

**Ответ:** Вы можете использовать метод `sendTo()` для отправки переменной `obj` из `admin/index_m.html` в код адаптера, проверить содержимое там, а затем предоставить результат через обратный вызов в `sendTo()` из `admin/index_m.html`.<br> Пример: это реализовано в адаптере [Fahrplan](https://github.com/gaudes/ioBroker.fahrplan).<br> ПРИМЕЧАНИЕ: Возможно, вам придется изменить `io-package.json`, см., например, [ioBroker-Forum: функция sendTo() не работает](https://forum.iobroker.net/topic/5205/gel%C3%B6st-sendto-in-eigenem-adapter-funktioniert-nicht/)<br> (24-ноя-2020)

### Функции адаптера
#### Запись файлов
**Вопрос:** Адаптер должен загрузить файл с axios и иметь возможность записать его в iobroker-data/files/<adapter>

**Ответ:** Вот небольшой фрагмент кода для этого действия:

```
const WebCall = await axios.get(url,{responseType: "arraybuffer"});
await Helper.Adapter.writeFileAsync(Helper.Adapter.namespace, `picture.jpg`, WebCall.data)
```

После этого в журнале ioBroker появилось предупреждение:<br> `writeFile will not write this file (picture.jpg) in future versions: <adapter> is not an object of type "meta"`<br> В io-package.json необходимо включить объект meta.user в instanceObjects:<br>

```
"instanceObjects": [
  {
    "_id": "",
    "type": "meta",
    "common": {
      "name": "User files for <Adapter>",
      "type": "meta.user"
    },
    "native": {}
  }
]
```

(09-дек-2020)